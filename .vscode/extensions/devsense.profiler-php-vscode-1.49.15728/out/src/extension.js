var Ef=Object.create;var sn=Object.defineProperty;var Cf=Object.getOwnPropertyDescriptor;var Tf=Object.getOwnPropertyNames;var bf=Object.getPrototypeOf,If=Object.prototype.hasOwnProperty;var d=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xf=(e,t)=>{for(var r in t)sn(e,r,{get:t[r],enumerable:!0})},Ua=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Tf(t))!If.call(e,i)&&i!==r&&sn(e,i,{get:()=>t[i],enumerable:!(n=Cf(t,i))||n.enumerable});return e};var or=(e,t,r)=>(r=e!=null?Ef(bf(e)):{},Ua(t||!e||!e.__esModule?sn(r,"default",{value:e,enumerable:!0}):r,e)),wf=e=>Ua(sn({},"__esModule",{value:!0}),e);var C=(e,t,r)=>new Promise((n,i)=>{var s=c=>{try{o(r.next(c))}catch(u){i(u)}},a=c=>{try{o(r.throw(c))}catch(u){i(u)}},o=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,a);o((r=r.apply(e,t)).next())});var Ci=d(za=>{var Ga=require("url"),Sf=require("child_process").spawn,bt=require("fs");za.XMLHttpRequest=function(){"use strict";var e=this,t=require("http"),r=require("https"),n,i,s={},a=!1,o={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},c={},u={},l=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],p=["TRACE","TRACK","CONNECT"],f=!1,v=!1,m={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;var b=function(g){return a||g&&l.indexOf(g.toLowerCase())===-1},k=function(g){return g&&p.indexOf(g)===-1};this.open=function(g,D,K,z,se){if(this.abort(),v=!1,!k(g))throw new Error("SecurityError: Request method not allowed");s={method:g,url:D.toString(),async:typeof K!="boolean"?!0:K,user:z||null,password:se||null},O(this.OPENED)},this.setDisableHeaderCheck=function(g){a=g},this.setRequestHeader=function(g,D){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!b(g)){console.warn('Refused to set unsafe header "'+g+'"');return}if(f)throw new Error("INVALID_STATE_ERR: send flag is true");g=u[g.toLowerCase()]||g,u[g.toLowerCase()]=g,c[g]=c[g]?c[g]+", "+D:D},this.getResponseHeader=function(g){return typeof g=="string"&&this.readyState>this.OPENED&&i&&i.headers&&i.headers[g.toLowerCase()]&&!v?i.headers[g.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||v)return"";var g="";for(var D in i.headers)D!=="set-cookie"&&D!=="set-cookie2"&&(g+=D+": "+i.headers[D]+`\r
`);return g.substr(0,g.length-2)},this.getRequestHeader=function(g){return typeof g=="string"&&u[g.toLowerCase()]?c[u[g.toLowerCase()]]:""},this.send=function(g){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(f)throw new Error("INVALID_STATE_ERR: send has already been called");var D=!1,K=!1,z=Ga.parse(s.url),se;switch(z.protocol){case"https:":D=!0;case"http:":se=z.hostname;break;case"file:":K=!0;break;case void 0:case null:case"":se="localhost";break;default:throw new Error("Protocol not supported.")}if(K){if(s.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(s.async)bt.readFile(z.pathname,"utf8",function(tt,ar){tt?e.handleError(tt):(e.status=200,e.responseText=ar,O(e.DONE))});else try{this.responseText=bt.readFileSync(z.pathname,"utf8"),this.status=200,O(e.DONE)}catch(tt){this.handleError(tt)}return}var rr=z.port||(D?443:80),yi=z.pathname+(z.search?z.search:"");for(var et in o)u[et.toLowerCase()]||(c[et]=o[et]);if(c.Host=se,D&&rr===443||rr===80||(c.Host+=":"+z.port),s.user){typeof s.password>"u"&&(s.password="");var vf=new Buffer(s.user+":"+s.password);c.Authorization="Basic "+vf.toString("base64")}s.method==="GET"||s.method==="HEAD"?g=null:g?(c["Content-Length"]=Buffer.isBuffer(g)?g.length:Buffer.byteLength(g),c["Content-Type"]||(c["Content-Type"]="text/plain;charset=UTF-8")):s.method==="POST"&&(c["Content-Length"]=0);var La={host:se,port:rr,path:yi,method:s.method,headers:c,agent:!1,withCredentials:e.withCredentials};if(v=!1,s.async){var Ha=D?r.request:t.request;f=!0,e.dispatchEvent("readystatechange");var gf=function tt(ar){if(i=ar,i.statusCode===301||i.statusCode===302||i.statusCode===303||i.statusCode===307){s.url=i.headers.location;var rn=Ga.parse(s.url);se=rn.hostname;var yf={hostname:rn.hostname,port:rn.port,path:rn.path,method:i.statusCode===303?"GET":s.method,headers:c,withCredentials:e.withCredentials};n=Ha(yf,tt).on("error",Fa),n.end();return}i.setEncoding("utf8"),O(e.HEADERS_RECEIVED),e.status=i.statusCode,i.on("data",function(nn){nn&&(e.responseText+=nn),f&&O(e.LOADING)}),i.on("end",function(){f&&(O(e.DONE),f=!1)}),i.on("error",function(nn){e.handleError(nn)})},Fa=function(ar){e.handleError(ar)};n=Ha(La,gf).on("error",Fa),g&&n.write(g),n.end(),e.dispatchEvent("loadstart")}else{var nr=".node-xmlhttprequest-content-"+process.pid,ir=".node-xmlhttprequest-sync-"+process.pid;bt.writeFileSync(ir,"","utf8");for(var mf="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(D?"s":"")+".request;var options = "+JSON.stringify(La)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+nr+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+ir+"');});response.on('error', function(error) {fs.writeFileSync('"+nr+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+ir+"');});}).on('error', function(error) {fs.writeFileSync('"+nr+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+ir+"');});"+(g?"req.write('"+JSON.stringify(g).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",_f=Sf(process.argv[0],["-e",mf]);bt.existsSync(ir););var sr=JSON.parse(bt.readFileSync(nr,"utf8"));_f.stdin.end(),bt.unlinkSync(nr),sr.err?e.handleError(sr.err):(i=sr.data,e.status=sr.data.statusCode,e.responseText=sr.data.text,O(e.DONE))}},this.handleError=function(g){this.status=0,this.statusText=g,this.responseText=g.stack,v=!0,O(this.DONE),this.dispatchEvent("error")},this.abort=function(){n&&(n.abort(),n=null),c=o,this.status=0,this.responseText="",this.responseXML="",v=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||f)&&this.readyState!==this.DONE&&(f=!1,O(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(g,D){g in m||(m[g]=[]),m[g].push(D)},this.removeEventListener=function(g,D){g in m&&(m[g]=m[g].filter(function(K){return K!==D}))},this.dispatchEvent=function(g){if(typeof e["on"+g]=="function"&&e["on"+g](),g in m)for(var D=0,K=m[g].length;D<K;D++)m[g][D].call(e)};var O=function(g){(g==e.LOADING||e.readyState!==g)&&(e.readyState=g,(s.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState===e.DONE&&!v&&(e.dispatchEvent("load"),e.dispatchEvent("loadend")))}}});var G=d((dy,Ka)=>{"use strict";var Of=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();Ka.exports=Of});var ln=d(Ve=>{"use strict";var Ya=Ve&&Ve.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Ve,"__esModule",{value:!0});var nt=it(),Nf=require("events"),kf;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(kf=Ve.SpanKind||(Ve.SpanKind={}));var Ja=function(){function e(){}return e.prototype.active=function(){var t=this,r=nt.CorrelationContextManager.getCurrentContext();return Ya({},r,{getValue:function(n){return t._activeSymbol?n===t._activeSymbol?r:!1:(t._activeSymbol=n,r)},setValue:function(){}})},e.prototype.with=function(t,r){var n=t.parentSpanId,i=t.name,s=e._spanToContext(t,n,i);return nt.CorrelationContextManager.runWithContext(s,r)()},e.prototype.bind=function(t){return typeof t=="function"?nt.CorrelationContextManager.wrapCallback(t):(t instanceof Nf.EventEmitter&&nt.CorrelationContextManager.wrapEmitter(t),t)},e.prototype.enable=function(){return nt.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return nt.CorrelationContextManager.disable(),this},e._spanToContext=function(t,r,n){var i=r?"|"+t.context().traceId+"."+r+".":t.context().traceId,s=Ya({},t.context(),{traceFlags:t.context().traceFlags.toString()}),a=nt.CorrelationContextManager.spanToContextObject(s,i,n);return a},e}();Ve.OpenTelemetryScopeManagerWrapper=Ja;Ve.AsyncScopeManager=new Ja});var En=d((E,vo)=>{E=vo.exports=I;var A;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?A=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:A=function(){};E.SEMVER_SPEC_VERSION="2.0.0";var ur=256,pn=Number.MAX_SAFE_INTEGER||9007199254740991,Ii=16,Mf=ur-6,lr=E.re=[],R=E.safeRe=[],h=E.src=[],T=0,Ai="[a-zA-Z0-9-]",xi=[["\\s",1],["\\d",ur],[Ai,Mf]];function mn(e){for(var t=0;t<xi.length;t++){var r=xi[t][0],n=xi[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var It=T++;h[It]="0|[1-9]\\d*";var xt=T++;h[xt]="\\d+";var Pi=T++;h[Pi]="\\d*[a-zA-Z-]"+Ai+"*";var eo=T++;h[eo]="("+h[It]+")\\.("+h[It]+")\\.("+h[It]+")";var to=T++;h[to]="("+h[xt]+")\\.("+h[xt]+")\\.("+h[xt]+")";var wi=T++;h[wi]="(?:"+h[It]+"|"+h[Pi]+")";var Si=T++;h[Si]="(?:"+h[xt]+"|"+h[Pi]+")";var Ri=T++;h[Ri]="(?:-("+h[wi]+"(?:\\."+h[wi]+")*))";var qi=T++;h[qi]="(?:-?("+h[Si]+"(?:\\."+h[Si]+")*))";var Di=T++;h[Di]=Ai+"+";var fr=T++;h[fr]="(?:\\+("+h[Di]+"(?:\\."+h[Di]+")*))";var Oi=T++,ro="v?"+h[eo]+h[Ri]+"?"+h[fr]+"?";h[Oi]="^"+ro+"$";var Ni="[v=\\s]*"+h[to]+h[qi]+"?"+h[fr]+"?",ki=T++;h[ki]="^"+Ni+"$";var Pt=T++;h[Pt]="((?:<|>)?=?)";var fn=T++;h[fn]=h[xt]+"|x|X|\\*";var dn=T++;h[dn]=h[It]+"|x|X|\\*";var st=T++;h[st]="[v=\\s]*("+h[dn]+")(?:\\.("+h[dn]+")(?:\\.("+h[dn]+")(?:"+h[Ri]+")?"+h[fr]+"?)?)?";var St=T++;h[St]="[v=\\s]*("+h[fn]+")(?:\\.("+h[fn]+")(?:\\.("+h[fn]+")(?:"+h[qi]+")?"+h[fr]+"?)?)?";var no=T++;h[no]="^"+h[Pt]+"\\s*"+h[st]+"$";var io=T++;h[io]="^"+h[Pt]+"\\s*"+h[St]+"$";var so=T++;h[so]="(?:^|[^\\d])(\\d{1,"+Ii+"})(?:\\.(\\d{1,"+Ii+"}))?(?:\\.(\\d{1,"+Ii+"}))?(?:$|[^\\d])";var _n=T++;h[_n]="(?:~>?)";var Dt=T++;h[Dt]="(\\s*)"+h[_n]+"\\s+";lr[Dt]=new RegExp(h[Dt],"g");R[Dt]=new RegExp(mn(h[Dt]),"g");var Lf="$1~",ao=T++;h[ao]="^"+h[_n]+h[st]+"$";var oo=T++;h[oo]="^"+h[_n]+h[St]+"$";var yn=T++;h[yn]="(?:\\^)";var At=T++;h[At]="(\\s*)"+h[yn]+"\\s+";lr[At]=new RegExp(h[At],"g");R[At]=new RegExp(mn(h[At]),"g");var Hf="$1^",co=T++;h[co]="^"+h[yn]+h[st]+"$";var uo=T++;h[uo]="^"+h[yn]+h[St]+"$";var Mi=T++;h[Mi]="^"+h[Pt]+"\\s*("+Ni+")$|^$";var Li=T++;h[Li]="^"+h[Pt]+"\\s*("+ro+")$|^$";var at=T++;h[at]="(\\s*)"+h[Pt]+"\\s*("+Ni+"|"+h[st]+")";lr[at]=new RegExp(h[at],"g");R[at]=new RegExp(mn(h[at]),"g");var Ff="$1$2$3",lo=T++;h[lo]="^\\s*("+h[st]+")\\s+-\\s+("+h[st]+")\\s*$";var po=T++;h[po]="^\\s*("+h[St]+")\\s+-\\s+("+h[St]+")\\s*$";var fo=T++;h[fo]="(<|>)?=?\\s*\\*";for(we=0;we<T;we++)A(we,h[we]),lr[we]||(lr[we]=new RegExp(h[we]),R[we]=new RegExp(mn(h[we])));var we;E.parse=ot;function ot(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof I)return e;if(typeof e!="string"||e.length>ur)return null;var r=t.loose?R[ki]:R[Oi];if(!r.test(e))return null;try{return new I(e,t)}catch{return null}}E.valid=Uf;function Uf(e,t){var r=ot(e,t);return r?r.version:null}E.clean=jf;function jf(e,t){var r=ot(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}E.SemVer=I;function I(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof I){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>ur)throw new TypeError("version is longer than "+ur+" characters");if(!(this instanceof I))return new I(e,t);A("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?R[ki]:R[Oi]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>pn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>pn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>pn||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<pn)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}I.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};I.prototype.toString=function(){return this.version};I.prototype.compare=function(e){return A("SemVer.compare",this.version,this.options,e),e instanceof I||(e=new I(e,this.options)),this.compareMain(e)||this.comparePre(e)};I.prototype.compareMain=function(e){return e instanceof I||(e=new I(e,this.options)),wt(this.major,e.major)||wt(this.minor,e.minor)||wt(this.patch,e.patch)};I.prototype.comparePre=function(e){if(e instanceof I||(e=new I(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(A("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return wt(r,n)}while(++t)};I.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};E.inc=$f;function $f(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new I(e,r).inc(t,n).version}catch{return null}}E.diff=Vf;function Vf(e,t){if(Hi(e,t))return null;var r=ot(e),n=ot(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}E.compareIdentifiers=wt;var Za=/^[0-9]+$/;function wt(e,t){var r=Za.test(e),n=Za.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}E.rcompareIdentifiers=Bf;function Bf(e,t){return wt(t,e)}E.major=Gf;function Gf(e,t){return new I(e,t).major}E.minor=zf;function zf(e,t){return new I(e,t).minor}E.patch=Qf;function Qf(e,t){return new I(e,t).patch}E.compare=Re;function Re(e,t,r){return new I(e,r).compare(new I(t,r))}E.compareLoose=Wf;function Wf(e,t){return Re(e,t,!0)}E.rcompare=Xf;function Xf(e,t,r){return Re(t,e,r)}E.sort=Kf;function Kf(e,t){return e.sort(function(r,n){return E.compare(r,n,t)})}E.rsort=Yf;function Yf(e,t){return e.sort(function(r,n){return E.rcompare(r,n,t)})}E.gt=pr;function pr(e,t,r){return Re(e,t,r)>0}E.lt=hn;function hn(e,t,r){return Re(e,t,r)<0}E.eq=Hi;function Hi(e,t,r){return Re(e,t,r)===0}E.neq=ho;function ho(e,t,r){return Re(e,t,r)!==0}E.gte=Fi;function Fi(e,t,r){return Re(e,t,r)>=0}E.lte=Ui;function Ui(e,t,r){return Re(e,t,r)<=0}E.cmp=vn;function vn(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Hi(e,r,n);case"!=":return ho(e,r,n);case">":return pr(e,r,n);case">=":return Fi(e,r,n);case"<":return hn(e,r,n);case"<=":return Ui(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}E.Comparator=de;function de(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof de){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof de))return new de(e,t);e=e.trim().split(/\s+/).join(" "),A("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===dr?this.value="":this.value=this.operator+this.semver.version,A("comp",this)}var dr={};de.prototype.parse=function(e){var t=this.options.loose?R[Mi]:R[Li],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new I(r[2],this.options.loose):this.semver=dr};de.prototype.toString=function(){return this.value};de.prototype.test=function(e){return A("Comparator.test",e,this.options.loose),this.semver===dr?!0:(typeof e=="string"&&(e=new I(e,this.options)),vn(e,this.operator,this.semver,this.options))};de.prototype.intersects=function(e,t){if(!(e instanceof de))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new M(e.value,t),gn(this.value,r,t);if(e.operator==="")return r=new M(this.value,t),gn(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=vn(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=vn(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||c};E.Range=M;function M(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof M)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new M(e.raw,t);if(e instanceof de)return new M(e.value,t);if(!(this instanceof M))return new M(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}M.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};M.prototype.toString=function(){return this.range};M.prototype.parseRange=function(e){var t=this.options.loose,r=t?R[po]:R[lo];e=e.replace(r,od),A("hyphen replace",e),e=e.replace(R[at],Ff),A("comparator trim",e,R[at]),e=e.replace(R[Dt],Lf),e=e.replace(R[At],Hf);var n=t?R[Mi]:R[Li],i=e.split(" ").map(function(s){return Zf(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new de(s,this.options)},this),i};M.prototype.intersects=function(e,t){if(!(e instanceof M))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};E.toComparators=Jf;function Jf(e,t){return new M(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Zf(e,t){return A("comp",e,t),e=rd(e,t),A("caret",e),e=ed(e,t),A("tildes",e),e=id(e,t),A("xrange",e),e=ad(e,t),A("stars",e),e}function te(e){return!e||e.toLowerCase()==="x"||e==="*"}function ed(e,t){return e.trim().split(/\s+/).map(function(r){return td(r,t)}).join(" ")}function td(e,t){var r=t.loose?R[oo]:R[ao];return e.replace(r,function(n,i,s,a,o){A("tilde",e,n,i,s,a,o);var c;return te(i)?c="":te(s)?c=">="+i+".0.0 <"+(+i+1)+".0.0":te(a)?c=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(A("replaceTilde pr",o),c=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):c=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",A("tilde return",c),c})}function rd(e,t){return e.trim().split(/\s+/).map(function(r){return nd(r,t)}).join(" ")}function nd(e,t){A("caret",e,t);var r=t.loose?R[uo]:R[co];return e.replace(r,function(n,i,s,a,o){A("caret",e,n,i,s,a,o);var c;return te(i)?c="":te(s)?c=">="+i+".0.0 <"+(+i+1)+".0.0":te(a)?i==="0"?c=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(A("replaceCaret pr",o),i==="0"?s==="0"?c=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):c=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(A("no pr"),i==="0"?s==="0"?c=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):c=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),A("caret return",c),c})}function id(e,t){return A("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return sd(r,t)}).join(" ")}function sd(e,t){e=e.trim();var r=t.loose?R[io]:R[no];return e.replace(r,function(n,i,s,a,o,c){A("xRange",e,n,i,s,a,o,c);var u=te(s),l=u||te(a),p=l||te(o),f=p;return i==="="&&f&&(i=""),u?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),A("xRange return",n),n})}function ad(e,t){return A("replaceStars",e,t),e.trim().replace(R[fo],"")}function od(e,t,r,n,i,s,a,o,c,u,l,p,f){return te(r)?t="":te(n)?t=">="+r+".0.0":te(i)?t=">="+r+"."+n+".0":t=">="+t,te(c)?o="":te(u)?o="<"+(+c+1)+".0.0":te(l)?o="<"+c+"."+(+u+1)+".0":p?o="<="+c+"."+u+"."+l+"-"+p:o="<="+o,(t+" "+o).trim()}M.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new I(e,this.options));for(var t=0;t<this.set.length;t++)if(cd(this.set[t],e,this.options))return!0;return!1};function cd(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(A(e[n].semver),e[n].semver!==dr&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}E.satisfies=gn;function gn(e,t,r){try{t=new M(t,r)}catch{return!1}return t.test(e)}E.maxSatisfying=ud;function ud(e,t,r){var n=null,i=null;try{var s=new M(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new I(n,r))}),n}E.minSatisfying=ld;function ld(e,t,r){var n=null,i=null;try{var s=new M(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new I(n,r))}),n}E.minVersion=pd;function pd(e,t){e=new M(e,t);var r=new I("0.0.0");if(e.test(r)||(r=new I("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new I(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||pr(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}E.validRange=fd;function fd(e,t){try{return new M(e,t).range||"*"}catch{return null}}E.ltr=dd;function dd(e,t,r){return ji(e,t,"<",r)}E.gtr=hd;function hd(e,t,r){return ji(e,t,">",r)}E.outside=ji;function ji(e,t,r,n){e=new I(e,n),t=new M(t,n);var i,s,a,o,c;switch(r){case">":i=pr,s=Ui,a=hn,o=">",c=">=";break;case"<":i=hn,s=Fi,a=pr,o="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(gn(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],p=null,f=null;if(l.forEach(function(v){v.semver===dr&&(v=new de(">=0.0.0")),p=p||v,f=f||v,i(v.semver,p.semver,n)?p=v:a(v.semver,f.semver,n)&&(f=v)}),p.operator===o||p.operator===c||(!f.operator||f.operator===o)&&s(e,f.semver))return!1;if(f.operator===c&&a(e,f.semver))return!1}return!0}E.prerelease=vd;function vd(e,t){var r=ot(e,t);return r&&r.prerelease.length?r.prerelease:null}E.intersects=gd;function gd(e,t,r){return e=new M(e,r),t=new M(t,r),e.intersects(t)}E.coerce=md;function md(e){if(e instanceof I)return e;if(typeof e!="string")return null;var t=e.match(R[so]);return t==null?null:ot(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var Vi=d($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});var _d=require("path"),yd=En(),mo=require("module"),Ed=Object.keys(process.binding("natives")),go=mo.prototype.require;function Cd(e){var t={};return function(n){var i=go.apply(this,arguments);if(e[n]){var s=mo._resolveFilename(n,this);if(t.hasOwnProperty(s))return t[s];var a=void 0;if(Ed.indexOf(n)<0)try{a=go.call(this,_d.join(n,"package.json")).version}catch{return i}else a=process.version.substring(1);var o=a.indexOf("-");o>=0&&(a=a.substring(0,o));for(var c=i,u=0,l=e[n];u<l.length;u++){var p=l[u];yd.satisfies(a,p.versionSpecifier)&&(c=p.patch(c,s))}return t[s]=c}return i}}$i.makePatchingRequire=Cd});var _o=d((gy,Td)=>{Td.exports={name:"diagnostic-channel",version:"0.3.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"^7.0.12",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"^2.2.1"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var U=d(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});var bd=Vi(),Id=Vi();Cn.makePatchingRequire=Id.makePatchingRequire;var yo=function(e){return!0},xd=function(){function e(){this.version=_o().version,this.subscribers={},this.contextPreservationFunction=function(t){return t},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(t){var r=this.subscribers[t];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},e.prototype.publish=function(t,r){if(!this.currentlyPublishing){var n=this.subscribers[t];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,o=s.filter;try{o&&o(!0)&&a(i)}catch{}}),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(t,r,n){n===void 0&&(n=yo),this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push({listener:r,filter:n})},e.prototype.unsubscribe=function(t,r,n){n===void 0&&(n=yo);var i=this.subscribers[t];if(i){for(var s=0;s<i.length;++s)if(i[s].listener===r&&i[s].filter===n)return i.splice(s,1),!0}return!1},e.prototype.reset=function(){var t=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete t.knownPatches[r]})},e.prototype.bindToContext=function(t){return this.contextPreservationFunction(t)},e.prototype.addContextPreservation=function(t){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return t(r(n))}},e.prototype.registerMonkeyPatch=function(t,r){this.knownPatches[t]||(this.knownPatches[t]=[]),this.knownPatches[t].push(r)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new xd,Eo=require("module"),Eo.prototype.require=bd.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var Eo;Cn.channel=global.diagnosticsSource});var To=d(qe=>{"use strict";var wd=qe&&qe.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(qe,"__esModule",{value:!0});var Tn=U();qe.AzureMonitorSymbol="Azure_Monitor_Tracer";var Co=!1,Sd=function(e){if(Co)return e;try{var t=require("@opentelemetry/tracing"),r=require("@opentelemetry/api"),n=Tn.channel.spanContextPropagator?{contextManager:Tn.channel.spanContextPropagator}:void 0;new t.BasicTracerProvider().register(n);var i=r.trace.getTracer("applicationinsights tracer"),s=i.startSpan;i.startSpan=function(a,o){if(!o||!o.parent){var c=r.getSpan(r.context.active());c&&c.operation&&c.operation.traceparent&&(o=wd({},o,{parent:{traceId:c.operation.traceparent.traceId,spanId:c.operation.traceparent.spanId,traceFlags:1}}))}var u=s.call(this,a,o),l=u.end;return u.end=function(){var p=l.apply(this,arguments);return Tn.channel.publish("azure-coretracing",u),p},u},r.getSpan(r.context.active()),i[qe.AzureMonitorSymbol]=!0,e.setTracer(i),Co=!0}catch{}return e};qe.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Sd};function Dd(){Tn.channel.registerMonkeyPatch("@azure/core-tracing",qe.azureCoreTracing)}qe.enable=Dd});var Io=d(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});var bo=U(),Ad=function(e){var t=e.prototype._emit;return e.prototype._emit=function(r,n){var i=t.apply(this,arguments);if(!n){var s=i;s||(s=t.call(this,r,!0)),bo.channel.publish("bunyan",{level:r.level,result:s})}return i},e};hr.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Ad};function Pd(){bo.channel.registerMonkeyPatch("bunyan",hr.bunyan)}hr.enable=Pd});var wo=d(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});var Bi=U(),xo=require("stream"),Rd=function(e){var t=new xo.Writable,r=new xo.Writable;t.write=function(u){if(!u)return!0;var l=u.toString();return Bi.channel.publish("console",{message:l}),!0},r.write=function(u){if(!u)return!0;var l=u.toString();return Bi.channel.publish("console",{message:l,stderr:!0}),!0};for(var n=new e.Console(t,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(u){var l=e[u];l&&(e[u]=function(){if(n[u])try{n[u].apply(n,arguments)}catch{}return l.apply(e,arguments)})},a=0,o=i;a<o.length;a++){var c=o[a];s(c)}return e};vr.console={versionSpecifier:">= 4.0.0",patch:Rd};function qd(){Bi.channel.registerMonkeyPatch("console",vr.console),require("console")}vr.enable=qd});var So=d(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});var Gi=U(),Od=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=Gi.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Gi.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e};gr.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Od};function Nd(){Gi.channel.registerMonkeyPatch("mongodb-core",gr.mongoCore)}gr.enable=Nd});var Ao=d(ye=>{"use strict";var Do=ye&&ye.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(ye,"__esModule",{value:!0});var Y=U(),kd=function(e){var t=e.instrument({operationIdGenerator:{next:function(){return Y.channel.bindToContext(function(n){return n()})}}}),r={};return t.on("started",function(n){r[n.requestId]||(r[n.requestId]=Do({},n,{time:new Date}))}),t.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Y.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):Y.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),t.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Y.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):Y.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),e},Md=function(e){var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=Y.channel.bindToContext(function(s){return s()}),r[i.requestId]=Do({},i,{time:new Date}))}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return Y.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return Y.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e},Ld=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=Y.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Y.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e},Hd=function(e){Ld(e);var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=Y.channel.bindToContext(function(s){return s()}),r[i.requestId]=i)}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return Y.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return Y.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e};ye.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:kd};ye.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:Md};ye.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:Hd};function Fd(){Y.channel.registerMonkeyPatch("mongodb",ye.mongo2),Y.channel.registerMonkeyPatch("mongodb",ye.mongo3),Y.channel.registerMonkeyPatch("mongodb",ye.mongo330)}ye.enable=Fd});var Ro=d(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});var bn=U(),Po=require("path"),Ud=function(e,t){var r=function(c,u){return function(l,p){var f=c[l];f&&(c[l]=function(){for(var m=arguments.length-1,b=arguments.length-1;b>=0;--b)if(typeof arguments[b]=="function"){m=b;break}else if(typeof arguments[b]<"u")break;var k=arguments[m],O={result:null,startTime:null,startDate:null};typeof k=="function"&&(p?(O.startTime=process.hrtime(),O.startDate=new Date,arguments[m]=bn.channel.bindToContext(p(O,k))):arguments[m]=bn.channel.bindToContext(k));var g=f.apply(this,arguments);return O.result=g,g})}},n=function(c,u){return r(c.prototype,u+".prototype")},i=["connect","changeUser","ping","statistics","end"],s=require(Po.dirname(t)+"/lib/Connection");i.forEach(function(c){return n(s,"Connection")(c)}),r(s,"Connection")("createQuery",function(c,u){return function(l){var p=process.hrtime(c.startTime),f=p[0]*1e3+p[1]/1e6|0;bn.channel.publish("mysql",{query:c.result,callbackArgs:arguments,err:l,duration:f,time:c.startDate}),u.apply(this,arguments)}});var a=["_enqueueCallback"],o=require(Po.dirname(t)+"/lib/Pool");return a.forEach(function(c){return n(o,"Pool")(c)}),e};mr.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:Ud};function jd(){bn.channel.registerMonkeyPatch("mysql",mr.mysql)}mr.enable=jd});var Oo=d(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});var qo=U();function $d(e){var t=e.prototype.connect;return e.prototype.connect=function(n){return n&&(arguments[0]=qo.channel.bindToContext(n)),t.apply(this,arguments)},e}_r.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:$d};function Vd(){qo.channel.registerMonkeyPatch("pg-pool",_r.postgresPool1)}_r.enable=Vd});var ko=d(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});var Rt=U(),No=require("events");function Bd(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var c={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},u=process.hrtime(),l;function p(f){f&&f[n]&&(f=f[n]);var v=Rt.channel.bindToContext(function(m,b){var k=process.hrtime(u);if(c.result=b&&{rowCount:b.rowCount,command:b.command},c.error=m,c.duration=Math.ceil(k[0]*1e3+k[1]/1e6),Rt.channel.publish("postgres",c),m){if(f)return f.apply(this,arguments);l&&l instanceof No.EventEmitter&&l.emit("error",m)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(v,n,{value:f}),v}catch{return f}}try{typeof s=="string"?a instanceof Array?(c.query.preparable={text:s,args:a},o=p(o)):(c.query.text=s,o?o=p(o):a=p(a)):(typeof s.name=="string"?c.query.plan=s.name:s.values instanceof Array?c.query.preparable={text:s.text,args:s.values}:c.query.text=s.text,o?o=p(o):a?a=p(a):s.callback=p(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,l=r.apply(this,arguments),l},e}function Gd(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var c=this,u=!!o,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},p=process.hrtime(),f;function v(m){m&&m[n]&&(m=m[n]);var b=Rt.channel.bindToContext(function(k,O){var g=process.hrtime(p);if(l.result=O&&{rowCount:O.rowCount,command:O.command},l.error=k,l.duration=Math.ceil(g[0]*1e3+g[1]/1e6),Rt.channel.publish("postgres",l),k){if(m)return m.apply(this,arguments);f&&f instanceof No.EventEmitter&&f.emit("error",k)}else m&&m.apply(this,arguments)});try{return Object.defineProperty(b,n,{value:m}),b}catch{return m}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},u=typeof o=="function",o=u?v(o):o):(l.query.text=s,o?(u=typeof o=="function",o=u?v(o):o):(u=typeof a=="function",a=u?v(a):a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,o?(u=typeof o=="function",o=v(o)):a?(u=typeof a=="function",a=u?v(a):a):(u=typeof s.callback=="function",s.callback=u?v(s.callback):s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,f=r.apply(this,arguments),u?f:f.then(function(m){return v()(void 0,m),new c._Promise(function(b,k){b(m)})}).catch(function(m){return v()(m,void 0),new c._Promise(function(b,k){k(m)})})},e}ct.postgres6={versionSpecifier:"6.*",patch:Bd};ct.postgres7={versionSpecifier:">=7.* <=8.*",patch:Gd};function zd(){Rt.channel.registerMonkeyPatch("pg",ct.postgres6),Rt.channel.registerMonkeyPatch("pg",ct.postgres7)}ct.enable=zd});var Mo=d(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});var zi=U(),Qd=function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,s=process.hrtime(),a=new Date;r.callback=zi.channel.bindToContext(function(o,c){var u=process.hrtime(s),l=u[0]*1e3+u[1]/1e6|0;zi.channel.publish("redis",{duration:l,address:i,commandObj:r,err:o,result:c,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return t.call(this,r)},e};yr.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Qd};function Wd(){zi.channel.registerMonkeyPatch("redis",yr.redis)}yr.enable=Wd});var Lo=d(ut=>{"use strict";var Xd=ut&&ut.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(ut,"__esModule",{value:!0});var Qi=U(),Kd=function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return Qi.channel.bindToContext(function(c,u,l){var p=process.hrtime(a);o=Xd({},o,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!c&&{rowCount:u,rows:l},query:{text:this.parametersByName.statement.value},error:c,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),Qi.channel.publish("tedious",o),s.call(this,c,u,l)})}var i=arguments[0];arguments[0].callback=n(i.callback),t.apply(this,arguments)},e};ut.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:Kd};function Yd(){Qi.channel.registerMonkeyPatch("tedious",ut.tedious)}ut.enable=Yd});var Ho=d(Ee=>{"use strict";var Jd=Ee&&Ee.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zd=Ee&&Ee.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(Ee,"__esModule",{value:!0});var In=U(),eh=function(e){var t=e.Logger.prototype.log,r,n=function(i,s,a){var o;return r===e.config.npm.levels?o="npm":r===e.config.syslog.levels?o="syslog":o="unknown",In.channel.publish("winston",{level:i,message:s,meta:a,levelKind:o}),s};return e.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),t.apply(this,arguments)},e},th=function(e){var t=function(a,o){var c;return a.config.npm.levels[o]!=null?c="npm":a.config.syslog.levels[o]!=null?c="syslog":c="unknown",c},r=function(a){Jd(o,a);function o(c,u){var l=a.call(this,u)||this;return l.winston=c,l}return o.prototype.log=function(c,u){var l=c.message,p=c.level,f=c.meta,v=Zd(c,["message","level","meta"]);p=typeof Symbol.for=="function"?c[Symbol.for("level")]:p,l=c instanceof Error?c:l;var m=t(this.winston,p);f=f||{};for(var b in v)v.hasOwnProperty(b)&&(f[b]=v[b]);In.channel.publish("winston",{message:l,level:p,levelKind:m,meta:f}),u()},o}(e.Transport);function n(){var a=arguments[0].levels||e.config.npm.levels,o;for(var c in a)a.hasOwnProperty(c)&&(o=o===void 0||a[c]>a[o]?c:o);this.add(new r(e,{level:o}))}var i=e.createLogger;e.createLogger=function(){var o=arguments[0].levels||e.config.npm.levels,c;for(var u in o)o.hasOwnProperty(u)&&(c=c===void 0||o[u]>o[c]?u:c);var l=i.apply(this,arguments);l.add(new r(e,{level:c}));var p=l.configure;return l.configure=function(){p.apply(this,arguments),n.apply(this,arguments)},l};var s=e.configure;return e.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},e.add(new r(e)),e};Ee.winston3={versionSpecifier:"3.x",patch:th};Ee.winston2={versionSpecifier:"2.x",patch:eh};function rh(){In.channel.registerMonkeyPatch("winston",Ee.winston2),In.channel.registerMonkeyPatch("winston",Ee.winston3)}Ee.enable=rh});var Ko=d(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});var Fo=To();ae.azuresdk=Fo;var Uo=Io();ae.bunyan=Uo;var jo=wo();ae.console=jo;var $o=So();ae.mongodbCore=$o;var Vo=Ao();ae.mongodb=Vo;var Bo=Ro();ae.mysql=Bo;var Go=Oo();ae.pgPool=Go;var zo=ko();ae.pg=zo;var Qo=Mo();ae.redis=Qo;var Wo=Lo();ae.tedious=Wo;var Xo=Ho();ae.winston=Xo;function nh(){Uo.enable(),jo.enable(),$o.enable(),Vo.enable(),Bo.enable(),zo.enable(),Go.enable(),Qo.enable(),Xo.enable(),Fo.enable(),Wo.enable()}ae.enable=nh});var Sn=d(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});var ih=ln(),Wi=G();qt.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var Xi="DiagnosticChannel";if(qt.IsInitialized){Ce=Ko(),Yo=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",xn=Yo.split(","),Ki={bunyan:Ce.bunyan,console:Ce.console,mongodb:Ce.mongodb,mongodbCore:Ce.mongodbCore,mysql:Ce.mysql,redis:Ce.redis,pg:Ce.pg,pgPool:Ce.pgPool,winston:Ce.winston,azuresdk:Ce.azuresdk};for(wn in Ki)xn.indexOf(wn)===-1&&(Ki[wn].enable(),Wi.info(Xi,"Subscribed to "+wn+" events"));xn.length>0&&Wi.info(Xi,"Some modules will not be patched",xn)}else Wi.info(Xi,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var Ce,Yo,xn,Ki,wn;function sh(e){if(!!qt.IsInitialized){var t=U();t.channel.addContextPreservation(e),t.channel.spanContextPropagator=ih.AsyncScopeManager}}qt.registerContextPreservation=sh});var Ot=d((Ry,Jo)=>{"use strict";Jo.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var le=d((Zi,ec)=>{"use strict";var Yi=Zi&&Zi.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},ah=require("http"),Zo=require("https"),Ji=require("url"),Dn=require("constants"),Er=G(),Nt=Ot(),oh=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&typeof r=="string")for(var i=t+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=e.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,s[a].length);break}}return n},e.trim=function(t){return typeof t=="string"?t.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(t){var r=function(o,c){return String.fromCharCode(o>>c&255)},n=function(o){return r(o,24)+r(o,16)+r(o,8)+r(o,0)},i=t.map(n).join(""),s=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=e.random32(),r+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var s=t[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(t){return t.length===32&&t!=="00000000000000000000000000000000"},e.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e.isError=function(t){return t instanceof Error},e.isPrimitive=function(t){var r=typeof t;return r==="string"||r==="number"||r==="boolean"},e.isDate=function(t){return Object.prototype.toString.call(t)==="[object Date]"},e.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var r=(t/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var a=s>0?s+".":"";return a+i+":"+n+":"+r},e.extractError=function(t){var r=t;return{message:t.message,code:r.code||r.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):typeof t.toJSON=="function"?t.toJSON():t},e.validateStringMap=function(t){if(typeof t!="object"){Er.info("Invalid properties dropped from payload");return}var r={};for(var n in t){var i="",s=t[n],a=typeof s;if(e.isPrimitive(s))i=s.toString();else if(s===null||a==="undefined")i="";else if(a==="function"){Er.info("key: "+n+" was function; will not serialize");continue}else{var o=e.isArray(s)?s:e.extractObject(s);try{e.isPrimitive(o)?i=o:i=JSON.stringify(o)}catch(c){i=s.constructor.name.toString()+" (Error: "+c.message+")",Er.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r},e.canIncludeCorrelationHeader=function(t,r){var n=t&&t.config&&t.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var s=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(s.test(Ji.parse(r).hostname))return!1}return!0},e.getCorrelationContextTarget=function(t,r){var n=t.headers&&t.headers[Nt.requestContextHeader];if(n)for(var i=n.split(","),s=0;s<i.length;++s){var a=i[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},e.makeRequest=function(t,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var s=Ji.parse(r),a=Yi({},n,{host:s.hostname,port:s.port,path:s.pathname}),o=void 0;if(s.protocol==="https:"&&(o=t.proxyHttpsUrl||void 0),s.protocol==="http:"&&(o=t.proxyHttpUrl||void 0),o){o.indexOf("//")===0&&(o="http:"+o);var c=Ji.parse(o);c.protocol==="https:"?(Er.info("Proxies that use HTTPS are not supported"),o=void 0):a=Yi({},a,{host:c.hostname,port:c.port||"80",path:r,headers:Yi({},a.headers,{Host:s.hostname})})}var u=s.protocol==="https:"&&!o;return u&&t.httpsAgent!==void 0?a.agent=t.httpsAgent:!u&&t.httpAgent!==void 0?a.agent=t.httpAgent:u&&(a.agent=e.tlsRestrictedAgent),u?Zo.request(a,i):ah.request(a,i)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(s){Er.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(Nt.requestContextHeader,Nt.requestContextSourceKey+"="+t.config.correlationId)},e.addCorrelationIdHeaderFromString=function(t,r,n){var i=n.split(","),s=Nt.requestContextSourceKey+"=",a=i.some(function(o){return o.substring(0,s.length)===s});a||r.setHeader(Nt.requestContextHeader,n+","+Nt.requestContextSourceKey+"="+t.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new Zo.Agent({secureOptions:Dn.SSL_OP_NO_SSLv2|Dn.SSL_OP_NO_SSLv3|Dn.SSL_OP_NO_TLSv1|Dn.SSL_OP_NO_TLSv1_1}),e}();ec.exports=oh});var lt=d((qy,tc)=>{"use strict";var An=le(),es=G(),ch=function(){function e(){}return e.queryCorrelationId=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(n)){r(e.completedLookups[n]);return}else if(e.pendingLookups[n]){e.pendingLookups[n].push(r);return}e.pendingLookups[n]=[r];var i=function(){if(!!e.pendingLookups[n]){var s={method:"GET",disableAppInsightsAutoCollection:!0};es.info(e.TAG,s);var a=An.makeRequest(t,n,s,function(o){if(o.statusCode===200){var c="";o.setEncoding("utf-8"),o.on("data",function(u){c+=u}),o.on("end",function(){es.info(e.TAG,c);var u=e.correlationIdPrefix+c;e.completedLookups[n]=u,e.pendingLookups[n]&&e.pendingLookups[n].forEach(function(l){return l(u)}),delete e.pendingLookups[n]})}else o.statusCode>=400&&o.statusCode<500?(e.completedLookups[n]=void 0,delete e.pendingLookups[n]):setTimeout(i,t.correlationIdRetryIntervalMs)});a&&(a.on("error",function(o){es.warn(e.TAG,o)}),a.end())}};setTimeout(i,0)},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter(function(s){return s!=r}),e.pendingLookups[n].length==0&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){t=t[0]=="|"?t:"|"+t,t[t.length-1]!=="."&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}else return e.generateRootId()},e.getRootId=function(t){var r=t.indexOf(".");r<0&&(r=t.length);var n=t[0]==="|"?1:0;return t.substring(n,r)},e.generateRootId=function(){return"|"+An.w3cTraceId()+"."},e.appendSuffix=function(t,r,n){if(t.length+r.length<e.requestIdMaxLength)return t+r+n;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var s=t[i-1];if(s==="."||s==="_")break}if(i<=1)return e.generateRootId();for(r=An.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=An.randomu32(),e}();tc.exports=ch});var Cr=d((Oy,rc)=>{"use strict";var Q=le(),uh=lt(),lh=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&typeof t=="string")if(t.split(",").length>1)this.traceId=Q.w3cTraceId(),this.spanId=Q.w3cTraceId().substr(0,16);else{var n=t.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=Q.w3cTraceId(),this.spanId=Q.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=Q.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=Q.w3cTraceId(),this.spanId=Q.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=e.DEFAULT_VERSION,this.traceId=Q.w3cTraceId(),this.spanId=Q.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=Q.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=Q.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=Q.w3cTraceId().substr(0,16),this.traceId=Q.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=uh.getRootId(r);e.isValidTraceId(s)||(this.legacyRootId=s,s=Q.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=Q.w3cTraceId(),this.spanId=Q.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&t!=="00000000000000000000000000000000"},e.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&t!=="0000000000000000"},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=Q.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();rc.exports=lh});var ts=d((Ny,nc)=>{"use strict";var ph=function(){function e(t){this.fieldmap=[],t&&(this.fieldmap=this.parseHeader(t))}return e.prototype.toString=function(){var t=this.fieldmap;return!t||t.length==0?null:t.join(", ")},e.validateKeyChars=function(t){var r=t.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),s=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),a=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&a}else if(r.length==1)return Boolean(t.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var s=0,a=i;s<a.length;s++){var o=a[s],c=o.trim();if(c.length!==0){var u=c.split("=");if(u.length!==2||!e.validateKeyChars(u[0])||n[u[0]])return null;n[u[0]]=!0,r.push(c)}}return r},e.strict=!0,e}();nc.exports=ph});var Oe=d((ky,ic)=>{"use strict";var fh=function(){function e(){}return e}();ic.exports=fh});var ac=d((rs,sc)=>{"use strict";var dh=rs&&rs.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hh=Oe(),vh=function(e){dh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(hh);sc.exports=vh});var ns=d((My,oc)=>{"use strict";var gh=function(){function e(){}return e}();oc.exports=gh});var uc=d((Ly,cc)=>{"use strict";var mh=function(){function e(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return e}();cc.exports=mh});var pc=d((is,lc)=>{"use strict";var _h=is&&is.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yh=ns(),Eh=function(e){_h(t,e);function t(){return e.call(this)||this}return t}(yh);lc.exports=Eh});var as=d((Hy,fc)=>{"use strict";var ss;(function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"})(ss||(ss={}));fc.exports=ss});var hc=d((Fy,dc)=>{"use strict";var Ch=as(),Th=function(){function e(){this.kind=Ch.Measurement}return e}();dc.exports=Th});var gc=d((Uy,vc)=>{"use strict";var bh=function(){function e(){this.ver=1,this.sampleRate=100,this.tags={}}return e}();vc.exports=bh});var cs=d((os,mc)=>{"use strict";var Ih=os&&os.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xh=Oe(),wh=function(e){Ih(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(xh);mc.exports=wh});var yc=d((us,_c)=>{"use strict";var Sh=us&&us.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dh=Oe(),Ah=function(e){Sh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return t}(Dh);_c.exports=Ah});var Cc=d((jy,Ec)=>{"use strict";var Ph=function(){function e(){this.hasFullStack=!0,this.parsedStack=[]}return e}();Ec.exports=Ph});var bc=d((ls,Tc)=>{"use strict";var Rh=ls&&ls.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),qh=Oe(),Oh=function(e){Rh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r}return t}(qh);Tc.exports=Oh});var xc=d((ps,Ic)=>{"use strict";var Nh=ps&&ps.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kh=Oe(),Mh=function(e){Nh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return t}(kh);Ic.exports=Mh});var Sc=d((fs,wc)=>{"use strict";var Lh=fs&&fs.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hh=cs(),Fh=function(e){Lh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Hh);wc.exports=Fh});var Ac=d((ds,Dc)=>{"use strict";var Uh=ds&&ds.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),jh=Oe(),$h=function(e){Uh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return t}(jh);Dc.exports=$h});var Rc=d((hs,Pc)=>{"use strict";var Vh=hs&&hs.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bh=Oe(),Gh=function(e){Vh(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Bh);Pc.exports=Gh});var Oc=d(($y,qc)=>{"use strict";var vs;(function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"})(vs||(vs={}));qc.exports=vs});var kc=d((Vy,Nc)=>{"use strict";var zh=function(){function e(){}return e}();Nc.exports=zh});var gs=d(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.AvailabilityData=ac();V.Base=ns();V.ContextTagKeys=uc();V.Data=pc();V.DataPoint=hc();V.DataPointType=as();V.Domain=Oe();V.Envelope=gc();V.EventData=cs();V.ExceptionData=yc();V.ExceptionDetails=Cc();V.MessageData=bc();V.MetricData=xc();V.PageViewData=Sc();V.RemoteDependencyData=Ac();V.RequestData=Rc();V.SeverityLevel=Oc();V.StackFrame=kc()});var Mc=d(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});var pt=gs(),Qh=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();Pn.RemoteDependencyDataConstants=Qh;function Wh(e){return"properties"in e||e instanceof pt.EventData||e instanceof pt.ExceptionData||e instanceof pt.MessageData||e instanceof pt.MetricData||e instanceof pt.PageViewData||e instanceof pt.RemoteDependencyData||e instanceof pt.RequestData}Pn.domainSupportsProperties=Wh});var Lc=d(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});function Xh(e){switch(e){case W.Event:return"EventData";case W.Exception:return"ExceptionData";case W.Trace:return"MessageData";case W.Metric:return"MetricData";case W.Request:return"RequestData";case W.Dependency:return"RemoteDependencyData";case W.Availability:return"AvailabilityData";case W.PageView:return"PageViewData"}}ft.telemetryTypeToBaseType=Xh;function Kh(e){switch(e){case"EventData":return W.Event;case"ExceptionData":return W.Exception;case"MessageData":return W.Trace;case"MetricData":return W.Metric;case"RequestData":return W.Request;case"RemoteDependencyData":return W.Dependency;case"AvailabilityData":return W.Availability;case"PageViewData":return W.PageView}}ft.baseTypeToTelemetryType=Kh;ft.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var W;(function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability",e[e.PageView=7]="PageView"})(W=ft.TelemetryType||(ft.TelemetryType={}))});var Hc=d(Rn=>{"use strict";function Yh(e){for(var t in e)Rn.hasOwnProperty(t)||(Rn[t]=e[t])}Object.defineProperty(Rn,"__esModule",{value:!0});Yh(Lc())});var oe=d(qn=>{"use strict";function ms(e){for(var t in e)qn.hasOwnProperty(t)||(qn[t]=e[t])}Object.defineProperty(qn,"__esModule",{value:!0});ms(Mc());ms(gs());ms(Hc())});var _s=d((Xy,Fc)=>{"use strict";var Jh=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(t,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=t;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var s in r)i[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=i},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();Fc.exports=Jh});var Cs=d((Es,jc)=>{"use strict";var Zh=Es&&Es.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),On=require("url"),ev=oe(),Uc=le(),dt=Ot(),tv=_s(),Be=lt(),rv=ts(),ys=Cr(),nv=function(e){Zh(t,e);function t(r,n){var i=e.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return t.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},t.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},t.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+On.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?n.time=r.time:this.startTime&&(n.time=new Date(this.startTime)),r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},t.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[t.keys.locationIp]=r[t.keys.locationIp]||this._getIp(),n[t.keys.sessionId]=r[t.keys.sessionId]||this._getId("ai_session"),n[t.keys.userId]=r[t.keys.userId]||this._getId("ai_user"),n[t.keys.userAuthUserId]=r[t.keys.userAuthUserId]||this._getId("ai_authUser"),n[t.keys.operationName]=this.getOperationName(r),n[t.keys.operationParentId]=this.getOperationParentId(r),n[t.keys.operationId]=this.getOperationId(r),n},t.prototype.getOperationId=function(r){return r[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(r){return r[t.keys.operationParentId]||this.parentId||this.getOperationId(r)},t.prototype.getOperationName=function(r){return r[t.keys.operationName]||this.method+" "+On.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=On.parse(r.url),s=i.pathname,a=i.search,o=On.format({protocol:n?"https":"http",host:r.headers.host,pathname:s,search:a});return o},t.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},t.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=t.parseId(Uc.getCookie(r,n));return i},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=Uc.getCorrelationContextTarget(r,dt.requestContextSourceKey),r.headers){var i=r.headers[dt.traceStateHeader],s=r.headers[dt.traceparentHeader],a=r.headers[dt.requestIdHeader],o=r.headers[dt.parentIdHeader],c=r.headers[dt.rootIdHeader];this.correlationContextHeader=r.headers[dt.correlationContextHeader],Be.w3cEnabled&&(s||i)?(this.traceparent=new ys(s),this.tracestate=s&&i&&new rv(i),this.setBackCompatFromThisTraceContext()):a?Be.w3cEnabled?(this.traceparent=new ys(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=Be.generateRequestId(this.parentId),this.operationId=Be.getRootId(this.requestId)):Be.w3cEnabled?(this.traceparent=new ys,this.traceparent.parentId=o,this.traceparent.legacyRootId=c||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=Be.generateRequestId(c||this.parentId),this.correlationContextHeader=null,this.operationId=Be.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=Be.getRootId(this.requestId))}},t.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},t.keys=new ev.ContextTagKeys,t}(tv);jc.exports=nv});var Nn=d((Ky,Bc)=>{"use strict";function Ts(e){return typeof e=="function"}var re=console.error.bind(console);function Tr(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function br(e){e&&e.logger&&(Ts(e.logger)?re=e.logger:re("new logger isn't a function, not replacing"))}function $c(e,t,r){if(!e||!e[t]){re("no original function "+t+" to wrap");return}if(!r){re("no wrapper function"),re(new Error().stack);return}if(!Ts(e[t])||!Ts(r)){re("original object and wrapper must be functions");return}var n=e[t],i=r(n,t);return Tr(i,"__original",n),Tr(i,"__unwrap",function(){e[t]===i&&Tr(e,t,n)}),Tr(i,"__wrapped",!0),Tr(e,t,i),i}function iv(e,t,r){if(e)Array.isArray(e)||(e=[e]);else{re("must provide one or more modules to patch"),re(new Error().stack);return}if(!(t&&Array.isArray(t))){re("must provide one or more functions to wrap on modules");return}e.forEach(function(n){t.forEach(function(i){$c(n,i,r)})})}function Vc(e,t){if(!e||!e[t]){re("no function to unwrap."),re(new Error().stack);return}if(!e[t].__unwrap)re("no original to unwrap to -- has "+t+" already been unwrapped?");else return e[t].__unwrap()}function sv(e,t){if(e)Array.isArray(e)||(e=[e]);else{re("must provide one or more modules to patch"),re(new Error().stack);return}if(!(t&&Array.isArray(t))){re("must provide one or more functions to unwrap on modules");return}e.forEach(function(r){t.forEach(function(n){Vc(r,n)})})}br.wrap=$c;br.massWrap=iv;br.unwrap=Vc;br.massUnwrap=sv;Bc.exports=br});var Ln=d((Yy,Wc)=>{"use strict";var zc=Nn(),kt=zc.wrap,kn=zc.unwrap,Ne="wrap@before";function Mn(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function av(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],s=e[Ne];if(typeof s=="function")s(i);else if(Array.isArray(s))for(var a=s.length,o=0;o<a;o++)s[o](i)}}function Qc(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r?r=[r]:r=[]),r}function ov(e,t,r){var n=Qc(e,t),i=n.filter(function(s){return r.indexOf(s)===-1});i.length>0&&av(e,i)}function Gc(e,t){if(!!e){var r=e;if(typeof e=="function")r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}Wc.exports=function(t,r,n){if(!t||!t.on||!t.addListener||!t.removeListener||!t.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(a){return function(c,u){var l=Qc(this,c).slice();try{var p=a.call(this,c,u);return ov(this,c,l),p}finally{this.on.__wrapped||kt(this,"on",i),this.addListener.__wrapped||kt(this,"addListener",i)}}}function s(a){return function(c){if(!this._events||!this._events[c])return a.apply(this,arguments);var u=this._events[c];function l(p){return function(){this._events[c]=u;try{return p.apply(this,arguments)}finally{u=this._events[c],this._events[c]=Gc(u,n)}}}kt(this,"removeListener",l);try{return this._events[c]=Gc(u,n),a.apply(this,arguments)}finally{kn(this,"removeListener"),this._events[c]=u}}}t[Ne]?typeof t[Ne]=="function"?Mn(t,Ne,[t[Ne],r]):Array.isArray(t[Ne])&&t[Ne].push(r):Mn(t,Ne,r),t.__wrapped||(kt(t,"addListener",i),kt(t,"on",i),kt(t,"emit",s),Mn(t,"__unwrap",function(){kn(t,"addListener"),kn(t,"on"),kn(t,"emit"),delete t[Ne],delete t.__wrapped}),Mn(t,"__wrapped",!0))}});var Jc=d((Jy,Yc)=>{"use strict";var S=require("util"),ke=require("assert"),cv=Ln(),q=require("async_hooks"),Ir="cls@contexts",xr="error@context",L=process.env.DEBUG_CLS_HOOKED,w=-1;Yc.exports={getNamespace:Xc,createNamespace:uv,destroyNamespace:Kc,reset:lv,ERROR_SYMBOL:xr};function he(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}he.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[t]=r,L){let n=" ".repeat(this._indent<0?0:this._indent);N(n+"CONTEXT-SET KEY:"+t+"="+r+" in ns:"+this.name+" currentUid:"+w+" active:"+S.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};he.prototype.get=function(t){if(!this.active){if(L){let r=q.currentId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);N(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${t}=undefined currentUid:${w} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(L){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);N(i+"CONTEXT-GETTING KEY:"+t+"="+this.active[t]+" ("+this.name+") currentUid:"+w+" active:"+S.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),N(`${i}CONTEXT-GETTING KEY: (${this.name}) ${t}=${this.active[t]} currentUid:${w} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${S.inspect(this.active)}`)}return this.active[t]};he.prototype.createContext=function(){let t=Object.create(this.active?this.active:Object.prototype);if(t._ns_name=this.name,t.id=w,L){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);N(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${w} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${S.inspect(t,{showHidden:!0,depth:2,colors:!0})}`)}return t};he.prototype.run=function(t){let r=this.createContext();this.enter(r);try{if(L){let n=q.triggerAsyncId(),i=q.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);N(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${w} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${S.inspect(r)}`)}return t(r),r}catch(n){throw n&&(n[xr]=r),n}finally{if(L){let n=q.triggerAsyncId(),i=q.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);N(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${w} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${S.inspect(r)}`)}this.exit(r)}};he.prototype.runAndReturn=function(t){let r;return this.run(function(n){r=t(n)}),r};he.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return L&&N("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+S.inspect(r)),n.then(i=>(L&&N("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+S.inspect(r)),this.exit(r),i)).catch(i=>{throw i[xr]=r,L&&N("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+S.inspect(r)),this.exit(r),i})};he.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[xr]=r),s}finally{n.exit(r)}}};he.prototype.enter=function(t){if(ke.ok(t,"context must be provided for entering"),L){let r=q.executionAsyncId(),n=q.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);N(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${w} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${S.inspect(t)}`)}this._set.push(this.active),this.active=t};he.prototype.exit=function(t){if(ke.ok(t,"context must be provided for exiting"),L){let n=q.executionAsyncId(),i=q.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);N(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${w} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${S.inspect(t)}`)}if(this.active===t){ke.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(L&&N("??ERROR?? context exiting but not entered - ignoring: "+S.inspect(t)),ke.ok(r>=0,`context not currently entered; can't exit. 
`+S.inspect(this)+`
`+S.inspect(t))):(ke.ok(r,"can't remove top context"),this._set.splice(r,1))};he.prototype.bindEmitter=function(t){ke.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[Ir]||(a[Ir]=Object.create(null)),a[Ir][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[Ir]))return a;let o=a,c=a[Ir];return Object.keys(c).forEach(function(u){let l=c[u];o=l.namespace.bind(o,l.context)}),o}cv(t,i,s)};he.prototype.fromException=function(t){return t[xr]};function Xc(e){return process.namespaces[e]}function uv(e){ke.ok(e,"namespace must be given a name."),L&&N(`NS-CREATING NAMESPACE (${e})`);let t=new he(e);return t.id=w,q.createHook({init(n,i,s,a){if(w=q.executionAsyncId(),t.active){if(t._contexts.set(n,t.active),L){let o=" ".repeat(t._indent<0?0:t._indent);N(`${o}INIT [${i}] (${e}) asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(w===0){let o=q.triggerAsyncId(),c=t._contexts.get(o);if(c){if(t._contexts.set(n,c),L){let u=" ".repeat(t._indent<0?0:t._indent);N(`${u}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${n} currentUid:${w} triggerId:${o} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(L){let u=" ".repeat(t._indent<0?0:t._indent);N(`${u}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${n} currentUid:${w} triggerId:${o} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(L&&i==="PROMISE"){N(S.inspect(a,{showHidden:!0}));let o=a.parentId,c=" ".repeat(t._indent<0?0:t._indent);N(`${c}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${o} asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){w=q.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(w),i){if(L){let s=q.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);N(`${a}BEFORE (${e}) asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${S.inspect(i)}`),t._indent+=2}t.enter(i)}else if(L){let s=q.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);N(`${a}BEFORE MISSING CONTEXT (${e}) asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${S.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(n){w=q.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(w),i){if(L){let s=q.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);N(`${a}AFTER (${e}) asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${S.inspect(i)}`)}t.exit(i)}else if(L){let s=q.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);N(`${a}AFTER MISSING CONTEXT (${e}) asyncId:${n} currentUid:${w} triggerId:${s} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${S.inspect(i)}`)}},destroy(n){if(w=q.executionAsyncId(),L){let i=q.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);N(`${s}DESTROY (${e}) currentUid:${w} asyncId:${n} triggerId:${i} active:${S.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${S.inspect(t._contexts.get(w))}`)}t._contexts.delete(n)}}).enable(),process.namespaces[e]=t,t}function Kc(e){let t=Xc(e);ke.ok(t,`can't delete nonexistent namespace! "`+e+'"'),ke.ok(t.id,"don't assign to process.namespaces directly! "+S.inspect(t)),process.namespaces[e]=null}function lv(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Kc(e)}),process.namespaces=Object.create(null)}process.namespaces={};function N(...e){L&&process._rawDebug(`${S.format(...e)}`)}});var eu=d((Zy,Zc)=>{"use strict";function pv(){}Zc.exports=function(){let t=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let c=0;c<arguments.length;c++)i[c]=arguments[c];let s=i[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new pv,o=--r.counter;return t.init.call(a,o,0,null,null),i[0]=function(){t.pre.call(a,o);let c=!0;try{s.apply(this,arguments),c=!1}finally{c&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(a,o,!0),t.destroy.call(null,o)})}t.post.call(a,o,!1),t.destroy.call(null,o)},n.apply(process,i)}}});var ru=d((eE,tu)=>{"use strict";function fv(){}tu.exports=function(){let t=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=c;function s(u,l,p,f){return typeof u!="function"?f?a(p):o(p):function(){t.pre.call(l,p);try{return u.apply(this,arguments)}finally{t.post.call(l,p,!1),t.destroy.call(null,p)}}}function a(u){return function(p){return t.destroy.call(null,u),p}}function o(u){return function(p){throw t.destroy.call(null,u),p}}function c(u,l){if(!r.enabled)return i.call(this,u,l);let p=new fv,f=--r.counter;return t.init.call(p,f,0,null,null),i.call(this,s(u,p,f,!0),s(l,p,f,!1))}}});var iu=d((tE,nu)=>{"use strict";var pe=require("timers");function dv(){}function hv(){}function vv(){}var gv=new Map,mv=new Map,_v=new Map,bs=null,Is=!1;nu.exports=function(){xs(this._hooks,this._state,"setTimeout","clearTimeout",dv,gv,!0),xs(this._hooks,this._state,"setInterval","clearInterval",hv,mv,!1),xs(this._hooks,this._state,"setImmediate","clearImmediate",vv,_v,!0),global.setTimeout=pe.setTimeout,global.setInterval=pe.setInterval,global.setImmediate=pe.setImmediate,global.clearTimeout=pe.clearTimeout,global.clearInterval=pe.clearInterval,global.clearImmediate=pe.clearImmediate};function xs(e,t,r,n,i,s,a){let o=pe[r],c=pe[n];pe[r]=function(){if(!t.enabled)return o.apply(pe,arguments);let u=new Array(arguments.length);for(let m=0;m<arguments.length;m++)u[m]=arguments[m];let l=u[0];if(typeof l!="function")throw new TypeError('"callback" argument must be a function');let p=new i,f=--t.counter,v;return e.init.call(p,f,0,null,null),u[0]=function(){bs=v,e.pre.call(p,f);let m=!0;try{l.apply(this,arguments),m=!1}finally{m&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(p,f,!0),s.delete(v),e.destroy.call(null,f)})}e.post.call(p,f,!1),bs=null,(a||Is)&&(Is=!1,s.delete(v),e.destroy.call(null,f))},v=o.apply(pe,u),s.set(v,f),v},pe[n]=function(u){if(bs===u&&u!==null)Is=!0;else if(s.has(u)){let l=s.get(u);s.delete(u),e.destroy.call(null,l)}c.apply(pe,arguments)}}});var ws=d((rE,yv)=>{yv.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var ou=d((nE,au)=>{"use strict";var Sr=process.binding("async_wrap"),Ev=Sr.Providers.TIMERWRAP,su={nextTick:eu(),promise:ru(),timers:iu()},wr=new Set;function Cv(){this.enabled=!1,this.counter=0}function Ss(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,s,a,o){if(s===Ev){wr.add(i);return}for(let c of e)c(i,this,s,a,o)},this.pre=function(i){if(!wr.has(i))for(let s of t)s(i,this)},this.post=function(i,s){if(!wr.has(i))for(let a of r)a(i,this,s)},this.destroy=function(i){if(wr.has(i)){wr.delete(i);return}for(let s of n)s(i)}}Ss.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)};function Hn(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}Ss.prototype.remove=function(e){e.init&&Hn(this.initFns,e.init),e.pre&&Hn(this.preFns,e.pre),e.post&&Hn(this.postFns,e.post),e.destroy&&Hn(this.destroyFns,e.destroy)};function Dr(){this._state=new Cv,this._hooks=new Ss,this.version=ws().version,this.providers=Sr.Providers;for(let e of Object.keys(su))su[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),Sr.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}au.exports=Dr;Dr.prototype.addHooks=function(e){this._hooks.add(e)};Dr.prototype.removeHooks=function(e){this._hooks.remove(e)};Dr.prototype.enable=function(){this._state.enabled=!0,Sr.enable()};Dr.prototype.disable=function(){this._state.enabled=!1,Sr.disable()}});var Ds=d((iE,Tv)=>{Tv.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var uu=d((sE,cu)=>{function bv(e){try{return Error.prototype.toString.call(e)}catch(t){try{return"<error: "+t+">"}catch{return"<error>"}}}cu.exports=function(t,r){var n=[];n.push(bv(t));for(var i=0;i<r.length;i++){var s=r[i],a;try{a=s.toString()}catch(o){try{a="<error: "+o+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var du=d((aE,fu)=>{var Fn=uu();function pu(){this.extend=new Ar,this.filter=new Ar,this.format=new Pr,this.version=Ds().version}var Ps=!1;pu.prototype.callSite=function e(t){t||(t={}),Ps=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return Ps=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var Ge=new pu;function Ar(){this._modifiers=[]}Ar.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t};Ar.prototype.attach=function(e){this._modifiers.push(e)};Ar.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return t===-1?!1:(this._modifiers.splice(t,1),!0)};function Pr(){this._formater=Fn,this._previous=void 0}Pr.prototype.replace=function(e){e?this._formater=e:this.restore()};Pr.prototype.restore=function(){this._formater=Fn,this._previous=void 0};Pr.prototype._backup=function(){this._previous=this._formater};Pr.prototype._roolback=function(){this._previous===Fn?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&Ge.format.replace(Error.prepareStackTrace);var As=!1;function lu(e,t){if(Ps)return t;if(As)return Fn(e,t);var r=t.concat();r=Ge.extend._modify(e,r),r=Ge.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&Object.getOwnPropertyDescriptor(e,"callSite")===void 0&&(e.callSite={original:t,mutated:r}),As=!0;var n=Ge.format._formater(e,r);return As=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return lu},set:function(e){e===lu?Ge.format._roolback():(Ge.format._backup(),Ge.format.replace(e))}});function Iv(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:Iv,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0});fu.exports=Ge});var qs=d((oE,Rs)=>{if(global._stackChain)if(global._stackChain.version===Ds().version)Rs.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else Rs.exports=global._stackChain=du()});var hu=d((cE,Os)=>{"use strict";var xv=ou();if(global._asyncHook)if(global._asyncHook.version===ws().version)Os.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else qs().filter.attach(function(t,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),Os.exports=global._asyncHook=new xv});var Eu=d((uE,yu)=>{"use strict";var $=require("util"),Me=require("assert"),wv=Ln(),Mt=hu(),Rr="cls@contexts",qr="error@context",gu=[];for(let e in Mt.providers)gu[Mt.providers[e]]=e;var F=process.env.DEBUG_CLS_HOOKED,B=-1;yu.exports={getNamespace:mu,createNamespace:Sv,destroyNamespace:_u,reset:Dv,ERROR_SYMBOL:qr};function ve(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}ve.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return F&&j("    SETTING KEY:"+t+"="+r+" in ns:"+this.name+" uid:"+B+" active:"+$.inspect(this.active,!0)),this.active[t]=r,r};ve.prototype.get=function(t){if(!this.active){F&&j("    GETTING KEY:"+t+"=undefined "+this.name+" uid:"+B+" active:"+$.inspect(this.active,!0));return}return F&&j("    GETTING KEY:"+t+"="+this.active[t]+" "+this.name+" uid:"+B+" active:"+$.inspect(this.active,!0)),this.active[t]};ve.prototype.createContext=function(){F&&j("   CREATING Context: "+this.name+" uid:"+B+" len:"+this._set.length+"  active:"+$.inspect(this.active,!0,2,!0));let t=Object.create(this.active?this.active:Object.prototype);return t._ns_name=this.name,t.id=B,F&&j("   CREATED Context: "+this.name+" uid:"+B+" len:"+this._set.length+"  context:"+$.inspect(t,!0,2,!0)),t};ve.prototype.run=function(t){let r=this.createContext();this.enter(r);try{return F&&j(" BEFORE RUN: "+this.name+" uid:"+B+" len:"+this._set.length+" "+$.inspect(r)),t(r),r}catch(n){throw n&&(n[qr]=r),n}finally{F&&j(" AFTER RUN: "+this.name+" uid:"+B+" len:"+this._set.length+" "+$.inspect(r)),this.exit(r)}};ve.prototype.runAndReturn=function(t){var r;return this.run(function(n){r=t(n)}),r};ve.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return F&&j(" BEFORE runPromise: "+this.name+" uid:"+B+" len:"+this._set.length+" "+$.inspect(r)),n.then(i=>(F&&j(" AFTER runPromise: "+this.name+" uid:"+B+" len:"+this._set.length+" "+$.inspect(r)),this.exit(r),i)).catch(i=>{throw i[qr]=r,F&&j(" AFTER runPromise: "+this.name+" uid:"+B+" len:"+this._set.length+" "+$.inspect(r)),this.exit(r),i})};ve.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[qr]=r),s}finally{n.exit(r)}}};ve.prototype.enter=function(t){Me.ok(t,"context must be provided for entering"),F&&j("  ENTER "+this.name+" uid:"+B+" len:"+this._set.length+" context: "+$.inspect(t)),this._set.push(this.active),this.active=t};ve.prototype.exit=function(t){if(Me.ok(t,"context must be provided for exiting"),F&&j("  EXIT "+this.name+" uid:"+B+" len:"+this._set.length+" context: "+$.inspect(t)),this.active===t){Me.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(F&&j("??ERROR?? context exiting but not entered - ignoring: "+$.inspect(t)),Me.ok(r>=0,`context not currently entered; can't exit. 
`+$.inspect(this)+`
`+$.inspect(t))):(Me.ok(r,"can't remove top context"),this._set.splice(r,1))};ve.prototype.bindEmitter=function(t){Me.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[Rr]||(a[Rr]=Object.create(null)),a[Rr][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[Rr]))return a;let o=a,c=a[Rr];return Object.keys(c).forEach(function(u){let l=c[u];o=l.namespace.bind(o,l.context)}),o}wv(t,i,s)};ve.prototype.fromException=function(t){return t[qr]};function mu(e){return process.namespaces[e]}function Sv(e){Me.ok(e,"namespace must be given a name."),F&&j("CREATING NAMESPACE "+e);let t=new ve(e);return t.id=B,Mt.addHooks({init(r,n,i,s,a){B=r,s?(t._contexts.set(r,t._contexts.get(s)),F&&j("PARENTID: "+e+" uid:"+r+" parent:"+s+" provider:"+i)):t._contexts.set(B,t.active),F&&j("INIT "+e+" uid:"+r+" parent:"+s+" provider:"+gu[i]+" active:"+$.inspect(t.active,!0))},pre(r,n){B=r;let i=t._contexts.get(r);i?(F&&j(" PRE "+e+" uid:"+r+" handle:"+Un(n)+" context:"+$.inspect(i)),t.enter(i)):F&&j(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+Un(n))},post(r,n){B=r;let i=t._contexts.get(r);i?(F&&j(" POST "+e+" uid:"+r+" handle:"+Un(n)+" context:"+$.inspect(i)),t.exit(i)):F&&j(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+Un(n))},destroy(r){B=r,F&&j("DESTROY "+e+" uid:"+r+" context:"+$.inspect(t._contexts.get(B))+" active:"+$.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t}function _u(e){let t=mu(e);Me.ok(t,`can't delete nonexistent namespace! "`+e+'"'),Me.ok(t.id,"don't assign to process.namespaces directly! "+$.inspect(t)),process.namespaces[e]=null}function Dv(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){_u(e)}),process.namespaces=Object.create(null)}process.namespaces={};Mt._state&&!Mt._state.enabled&&Mt.enable();function j(e){process.env.DEBUG&&process._rawDebug(e)}function Un(e){if(!e)return e;if(typeof e=="function")return e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(e.constructor&&e.constructor.name)return e.constructor.name}if(F){Ns=qs();for(vu in Ns.filter._modifiers)Ns.filter.deattach(vu)}var Ns,vu});var Cu=d((lE,ks)=>{"use strict";var Av=En();process&&Av.gte(process.versions.node,"8.0.0")?ks.exports=Jc():ks.exports=Eu()});var Iu=d((pE,bu)=>{var Pv=Nn().wrap,Ls=1<<0,Hs=1<<1,Fs=1<<2,$n=1<<3,P=[],Rv=0,J=!1,ze=[],Lt,Us;function js(e,t){var r=e.length,n=t.length,i=[];if(r===0&&n===0)return i;for(var s=0;s<r;s++)i[s]=e[s];if(n===0)return i;for(var a=0;a<n;a++){var o=!0;for(s=0;s<r;s++)if(e[s].uid===t[a].uid){o=!1;break}o&&i.push(t[a])}return i}process._fatalException?(jn=!1,Lt=function(t){var r=P.length;if(jn||r===0)return!1;var n=!1;jn=!0;for(var i=0;i<r;++i){var s=P[i];if((s.flags&$n)!==0){var a=Ht&&Ht[s.uid];n=s.error(a,t)||n}}return jn=!1,ze.length>0&&(P=ze.pop()),Ht=void 0,n&&!J},Us=function(t,r,n){var i=[];J=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Ls)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return J=!1,function(){Ht=i,ze.push(P),P=js(r,P),J=!0;for(var c=0;c<n;++c)(r[c].flags&Hs)>0&&r[c].before(this,i[r[c].uid]);J=!1;var u=t.apply(this,arguments);for(J=!0,c=0;c<n;++c)(r[c].flags&Fs)>0&&r[c].after(this,i[r[c].uid]);return J=!1,P=ze.pop(),Ht=void 0,u}},Pv(process,"_fatalException",function(e){return function(r){return Lt(r)||e(r)}})):(Ms=!1,Lt=function(t){if(Ms)throw t;for(var r=!1,n=P.length,i=0;i<n;++i){var s=P[i];(s.flags&$n)!==0&&(r=s.error(null,t)||r)}if(!r&&J)throw t},Us=function(t,r,n){var i=[];J=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Ls)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return J=!1,function(){var c=!1,u=!1;ze.push(P),P=js(r,P),J=!0;for(var l=0;l<n;++l)(r[l].flags&Hs)>0&&r[l].before(this,i[r[l].uid]);J=!1;var p;try{p=t.apply(this,arguments)}catch(f){c=!0;for(var l=0;l<n;++l)if((P[l].flags&$n)!=0)try{u=P[l].error(i[r[l].uid],f)||u}catch(m){throw Ms=!0,m}if(!u)throw process.removeListener("uncaughtException",Lt),process._originalNextTick(function(){process.addListener("uncaughtException",Lt)}),f}finally{if(!c||u){for(J=!0,l=0;l<n;++l)(r[l].flags&Fs)>0&&r[l].after(this,i[r[l].uid]);J=!1}P=ze.pop()}return p}},process.addListener("uncaughtException",Lt));var jn,Ht,Ms;function qv(e,t,r){J=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return J=!1,function(){ze.push(P),P=js(t,P);var s=e.apply(this,arguments);return P=ze.pop(),s}}function Ov(e){var t=P.length;if(t===0)return e;for(var r=P.slice(),n=0;n<t;++n)if(r[n].flags>0)return Us(e,r,t);return qv(e,r,t)}function Se(e,t){typeof e.create=="function"&&(this.create=e.create,this.flags|=Ls),typeof e.before=="function"&&(this.before=e.before,this.flags|=Hs),typeof e.after=="function"&&(this.after=e.after,this.flags|=Fs),typeof e.error=="function"&&(this.error=e.error,this.flags|=$n),this.uid=++Rv,this.data=t===void 0?null:t}Se.prototype.create=void 0;Se.prototype.before=void 0;Se.prototype.after=void 0;Se.prototype.error=void 0;Se.prototype.data=void 0;Se.prototype.uid=0;Se.prototype.flags=0;function Tu(e,t){if(typeof e!="object"||!e)throw new TypeError("callbacks argument must be an object");return e instanceof Se?e:new Se(e,t)}function Nv(e,t){var r;e instanceof Se?r=e:r=Tu(e,t);for(var n=!1,i=0;i<P.length;i++)if(r===P[i]){n=!0;break}return n||P.push(r),r}function kv(e){for(var t=0;t<P.length;t++)if(e===P[t]){P.splice(t,1);break}}process.createAsyncListener=Tu;process.addAsyncListener=Nv;process.removeAsyncListener=kv;bu.exports=Ov});var wu=d((dE,xu)=>{"use strict";xu.exports=(e,t)=>class extends e{constructor(n){var i,s;super(o);var a=this;try{n.apply(i,s)}catch(c){s[1](c)}return a;function o(c,u){i=this,s=[l,p];function l(f){return t(a,!1),c(f)}function p(f){return t(a,!1),u(f)}}}}});var Ou=d(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var Pu=Nn(),Bn=En(),ce=Pu.wrap,Qe=Pu.massWrap,H=Iu(),Mv=require("util"),Lv=Bn.gte(process.version,"6.0.0"),Bs=Bn.gte(process.version,"7.0.0"),Hv=Bn.gte(process.version,"8.0.0"),Fv=Bn.gte(process.version,"11.0.0"),De=require("net");Bs&&!De._normalizeArgs?De._normalizeArgs=function(e){if(e.length===0)return[{},null];var t=e[0],r={};typeof t=="object"&&t!==null?r=t:Bv(t)?r.path=t:(r.port=t,e.length>1&&typeof e[1]=="string"&&(r.host=e[1]));var n=e[e.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Bs&&!De._normalizeConnectArgs&&(De._normalizeConnectArgs=function(e){var t={};function r(i){return(i=Number(i))>=0?i:!1}typeof e[0]=="object"&&e[0]!==null?t=e[0]:typeof e[0]=="string"&&r(e[0])===!1?t.path=e[0]:(t.port=e[0],typeof e[1]=="string"&&(t.host=e[1]));var n=e[e.length-1];return typeof n=="function"?[t,n]:[t]});"_setUpListenHandle"in De.Server.prototype?ce(De.Server.prototype,"_setUpListenHandle",Su):ce(De.Server.prototype,"_listen2",Su);function Su(e){return function(){this.on("connection",function(t){t._handle&&(t._handle.onread=H(t._handle.onread))});try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=H(this._handle.onconnection))}}}function Ru(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=H(t._originalOnread)}}ce(De.Socket.prototype,"connect",function(e){return function(){var t;Hv&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?t=arguments[0]:t=Bs?De._normalizeArgs(arguments):De._normalizeConnectArgs(arguments),t[1]&&(t[1]=H(t[1]));var r=e.apply(this,t);return Ru(this),r}});var Uv=require("http");ce(Uv.Agent.prototype,"addRequest",function(e){return function(t){var r=t.onSocket;return t.onSocket=H(function(n){return Ru(n),r.apply(this,arguments)}),e.apply(this,arguments)}});var $s=require("child_process");function Du(e){Array.isArray(e.stdio)&&e.stdio.forEach(function(t){t&&t._handle&&(t._handle.onread=H(t._handle.onread),ce(t._handle,"close",Gn))}),e._handle&&(e._handle.onexit=H(e._handle.onexit))}$s.ChildProcess?ce($s.ChildProcess.prototype,"spawn",function(e){return function(){var t=e.apply(this,arguments);return Du(this),t}}):Qe($s,["execFile","fork","spawn"],function(e){return function(){var t=e.apply(this,arguments);return Du(t),t}});process._fatalException||(process._originalNextTick=process.nextTick);var Qs=[];process._nextDomainTick&&Qs.push("_nextDomainTick");process._tickDomainCallback&&Qs.push("_tickDomainCallback");Qe(process,Qs,Ae);ce(process,"nextTick",Gn);var Ws=["setTimeout","setInterval"];global.setImmediate&&Ws.push("setImmediate");var qu=require("timers"),jv=global.setTimeout===qu.setTimeout;Qe(qu,Ws,Gn);jv&&Qe(global,Ws,Gn);var Gs=require("dns");Qe(Gs,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Ae);Gs.resolveNaptr&&ce(Gs,"resolveNaptr",Ae);var vt=require("fs");Qe(vt,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Ae);vt.lchown&&ce(vt,"lchown",Ae);vt.lchmod&&ce(vt,"lchmod",Ae);vt.ftruncate&&ce(vt,"ftruncate",Ae);var Or;try{Or=require("zlib")}catch{}Or&&Or.Deflate&&Or.Deflate.prototype&&(ht=Object.getPrototypeOf(Or.Deflate.prototype),ht._transform?ce(ht,"_transform",Ae):ht.write&&ht.flush&&ht.end&&Qe(ht,["write","flush","end"],Ae));var ht,zs;try{zs=require("crypto")}catch{}zs&&(Vs=["pbkdf2","randomBytes"],Fv||Vs.push("pseudoRandomBytes"),Qe(zs,Vs,Ae));var Vs,Vn=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";Vn&&(Au=process.addAsyncListener({create:function(){Vn=!1}}),global.Promise.resolve(!0).then(function(){Vn=!1}),process.removeAsyncListener(Au));var Au;Vn&&$v();function $v(){var e=global.Promise;function t(a){if(!(this instanceof t))return e(a);if(typeof a!="function")return new e(a);var o,c,u=new e(l);u.__proto__=t.prototype;try{a.apply(o,c)}catch(p){c[1](p)}return u;function l(p,f){o=this,c=[v,m];function v(b){return n(u,!1),p(b)}function m(b){return n(u,!1),f(b)}}}if(Mv.inherits(t,e),ce(e.prototype,"then",s),e.prototype.chain&&ce(e.prototype,"chain",s),Lv)global.Promise=wu()(e,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof e[a]=="function"&&(t[a]=e[a])}),global.Promise=t}function n(a,o){(!a.__asl_wrapper||o)&&(a.__asl_wrapper=H(i))}function i(a,o,c,u){var l;try{return l=o.call(a,c),{returnVal:l,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{l instanceof e?u.__asl_wrapper=function(){var f=l.__asl_wrapper||i;return f.apply(this,arguments)}:n(u,!0)}}function s(a){return function(){var c=this,u=a.apply(c,Array.prototype.map.call(arguments,l));return u.__asl_wrapper=function(f,v,m,b){return c.__asl_wrapper?(c.__asl_wrapper(f,function(){},null,u),u.__asl_wrapper(f,v,m,b)):i(f,v,m,b)},u;function l(p){return typeof p!="function"?p:H(function(f){var v=(c.__asl_wrapper||i)(this,p,f,u);if(v.error)throw v.errorVal;return v.returnVal})}}}}function Ae(e){var t=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=H(arguments[n])}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof n=="function"&&(n=H(n)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof i=="function"&&(i=H(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof s=="function"&&(s=H(s)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof a=="function"&&(a=H(a)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof o=="function"&&(o=H(o)),e.call(this,r,n,i,s,a,o))};default:return t}}function Gn(e){var t=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=H(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof r=="function"&&(r=H(r)),e.call(this,r,n,i,s,a,o))};default:return t}}function Vv(e){return(e=Number(e))>=0?e:!1}function Bv(e){return typeof e=="string"&&Vv(e)===!1}});var Hu=d((gE,Lu)=>{"use strict";var Le=require("assert"),Gv=Ln(),Nr="cls@contexts",Xs="error@context";process.addAsyncListener||Ou();function Te(e){this.name=e,this.active=null,this._set=[],this.id=null}Te.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t};Te.prototype.get=function(e){if(!!this.active)return this.active[e]};Te.prototype.createContext=function(){return Object.create(this.active)};Te.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(r){throw r&&(r[Xs]=t),r}finally{this.exit(t)}};Te.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};Te.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(n){throw n&&(n[Xs]=t),n}finally{r.exit(t)}}};Te.prototype.enter=function(e){Le.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e};Te.prototype.exit=function(e){if(Le.ok(e,"context must be provided for exiting"),this.active===e){Le.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var t=this._set.lastIndexOf(e);Le.ok(t>=0,"context not currently entered; can't exit"),Le.ok(t,"can't remove top context"),this._set.splice(t,1)};Te.prototype.bindEmitter=function(e){Le.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;function n(s){!s||(s[Nr]||(s[Nr]=Object.create(null)),s[Nr][r]={namespace:t,context:t.active})}function i(s){if(!(s&&s[Nr]))return s;var a=s,o=s[Nr];return Object.keys(o).forEach(function(c){var u=o[c];a=u.namespace.bind(a,u.context)}),a}Gv(e,n,i)};Te.prototype.fromException=function(e){return e[Xs]};function Nu(e){return process.namespaces[e]}function zv(e){Le.ok(e,"namespace must be given a name!");var t=new Te(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(r,n){n&&t.enter(n)},after:function(r,n){n&&t.exit(n)},error:function(r){r&&t.exit(r)}}),process.namespaces[e]=t,t}function ku(e){var t=Nu(e);Le.ok(t,"can't delete nonexistent namespace!"),Le.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function Mu(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){ku(e)}),process.namespaces=Object.create(null)}process.namespaces||Mu();Lu.exports={getNamespace:Nu,createNamespace:zv,destroyNamespace:ku,reset:Mu}});var it=d(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});var Uu=G(),Qv=Sn(),kr=Cr(),Ks=ts(),Fu=Cs(),Wv=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return t===void 0?null:t},e.generateContextObject=function(t,r,n,i,s,a){return r=r||t,this.enabled?{operation:{name:n,id:t,parentId:r,traceparent:s,tracestate:a},customProperties:new Xv(i)}:null},e.spanToContextObject=function(t,r,n){var i=new kr;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=t.traceFlags||kr.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,n,null,i)},e.runWithContext=function(t,r){if(e.enabled)return e.session.bind(r,(n={},n[e.CONTEXT_NAME]=t,n))();return r();var n},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){if(e.enabled)return e.session.bind(t,r?(n={},n[e.CONTEXT_NAME]=r,n):void 0);return t;var n},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(e.forceClsHooked===!0||e.forceClsHooked===void 0&&e.shouldUseClsHooked()?this.cls=Cu():this.cls=Hu()),e.session=this.cls.createNamespace("AI-CLS-Session"),Qv.registerContextPreservation(function(r){return e.session.bind(r)})),this.enabled=!0}},e.startOperation=function(t,r){var n=t&&t.traceContext||null,i=t&&t.traceId?t:null,s=t&&t.headers;if(i){var a=new kr("00-"+i.traceId+"-"+i.spanId+"-01"),o=new Ks(i.tracestate),c=e.generateContextObject(i.traceId,"|"+i.traceId+"."+i.spanId+".",typeof r=="string"?r:"",void 0,a,o);return c}if(n){var a=new kr(n.traceparent),o=new Ks(n.tracestate),u=typeof r=="object"?new Fu(r):null,c=e.generateContextObject(a.traceId,a.parentId,typeof r=="string"?r:u.getOperationName({}),u&&u.getCorrelationContextHeader()||void 0,a,o);return c}if(s){var a=new kr(s.traceparent),o=new Ks(s.tracestate),u=new Fu(t),c=e.generateContextObject(a.traceId,a.parentId,u.getOperationName({}),u.getCorrelationContextHeader(),a,o);return c}return Uu.warn("startOperation was called with invalid arguments",arguments),null},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>3||parseInt(t[0])>2&&parseInt(t[1])>2},e.shouldUseClsHooked=function(){var t=process.versions.node.split(".");return parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=2},e.canUseClsHooked=function(){var t=process.versions.node.split("."),r=parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=0,n=parseInt(t[0])<8||parseInt(t[0])<=8&&parseInt(t[1])<2,i=parseInt(t[0])>4||parseInt(t[0])>=4&&parseInt(t[1])>=7;return!(r&&n)&&i},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();Ys.CorrelationContextManager=Wv;var Xv=function(){function e(t){this.props=[],this.addHeaderData(t)}return e.prototype.addHeaderData=function(t){var r=t?t.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map(function(t){return t.key+"="+t.value}).join(", ")},e.prototype.getProperty=function(t){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===t)return n.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r)){Uu.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===t){i.value=r;return}}this.props.push({key:t,value:r})},e.bannedCharacters=/[,=]/,e}()});var $u=d(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});var ju=oe(),Js=U(),gt=[],Zs=function(e){var t=e.data.message;gt.forEach(function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf(`
`)==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?ju.SeverityLevel.Warning:ju.SeverityLevel.Information}))})};function Kv(e,t){e?(gt.length===0&&Js.channel.subscribe("console",Zs),gt.push(t)):(gt=gt.filter(function(r){return r!=t}),gt.length===0&&Js.channel.unsubscribe("console",Zs))}zn.enable=Kv;function Yv(){Js.channel.unsubscribe("console",Zs),gt=[]}zn.dispose=Yv});var Vu=d(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});var Ft=oe(),ea=U(),mt=[],Jv={10:Ft.SeverityLevel.Verbose,20:Ft.SeverityLevel.Verbose,30:Ft.SeverityLevel.Information,40:Ft.SeverityLevel.Warning,50:Ft.SeverityLevel.Error,60:Ft.SeverityLevel.Critical},ta=function(e){var t=e.data.result;mt.forEach(function(r){var n=Jv[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})})};function Zv(e,t){e?(mt.length===0&&ea.channel.subscribe("bunyan",ta),mt.push(t)):(mt=mt.filter(function(r){return r!=t}),mt.length===0&&ea.channel.unsubscribe("bunyan",ta))}Qn.enable=Zv;function eg(){ea.channel.unsubscribe("bunyan",ta),mt=[]}Qn.dispose=eg});var Bu=d(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});var X=oe(),ra=U(),_t=[],tg={syslog:function(e){var t={emerg:X.SeverityLevel.Critical,alert:X.SeverityLevel.Critical,crit:X.SeverityLevel.Critical,error:X.SeverityLevel.Error,warning:X.SeverityLevel.Warning,notice:X.SeverityLevel.Information,info:X.SeverityLevel.Information,debug:X.SeverityLevel.Verbose};return t[e]===void 0?X.SeverityLevel.Information:t[e]},npm:function(e){var t={error:X.SeverityLevel.Error,warn:X.SeverityLevel.Warning,info:X.SeverityLevel.Information,verbose:X.SeverityLevel.Verbose,debug:X.SeverityLevel.Verbose,silly:X.SeverityLevel.Verbose};return t[e]===void 0?X.SeverityLevel.Information:t[e]},unknown:function(e){return X.SeverityLevel.Information}},na=function(e){var t=e.data.message;_t.forEach(function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=tg[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}})};function rg(e,t){e?(_t.length===0&&ra.channel.subscribe("winston",na),_t.push(t)):(_t=_t.filter(function(r){return r!=t}),_t.length===0&&ra.channel.unsubscribe("winston",na))}Wn.enable=rg;function ng(){ra.channel.unsubscribe("winston",na),_t=[]}Wn.dispose=ng});var zu=d((CE,Gu)=>{"use strict";var ig=Sn(),sg=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(t,r){ig.IsInitialized&&($u().enable(t&&r,this._client),Vu().enable(t,this._client),Bu().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();Gu.exports=sg});var Wu=d((TE,Qu)=>{"use strict";var ag=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(s,a,o){o===void 0&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),s&&a&&process.listeners(a).length===1&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();Qu.exports=ag});var We=d(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";x.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";x.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var Z;(function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(Z=x.QuickPulseCounter||(x.QuickPulseCounter={}));var Xn;(function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(Xn=x.PerformanceCounter||(x.PerformanceCounter={}));x.PerformanceToQuickPulseCounter=(be={},be[Xn.PROCESSOR_TIME]=Z.PROCESSOR_TIME,be[Xn.REQUEST_RATE]=Z.REQUEST_RATE,be[Xn.REQUEST_DURATION]=Z.REQUEST_DURATION,be[Z.COMMITTED_BYTES]=Z.COMMITTED_BYTES,be[Z.REQUEST_FAILURE_RATE]=Z.REQUEST_FAILURE_RATE,be[Z.DEPENDENCY_RATE]=Z.DEPENDENCY_RATE,be[Z.DEPENDENCY_FAILURE_RATE]=Z.DEPENDENCY_FAILURE_RATE,be[Z.DEPENDENCY_DURATION]=Z.DEPENDENCY_DURATION,be[Z.EXCEPTION_RATE]=Z.EXCEPTION_RATE,be);x.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};x.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};x.TelemetryTypeStringToQuickPulseType={EventData:x.QuickPulseType.Event,ExceptionData:x.QuickPulseType.Exception,MessageData:x.QuickPulseType.Trace,MetricData:x.QuickPulseType.Metric,RequestData:x.QuickPulseType.Request,RemoteDependencyData:x.QuickPulseType.Dependency,AvailabilityData:x.QuickPulseType.Availability,PageViewData:x.QuickPulseType.PageView};x.TelemetryTypeStringToQuickPulseDocumentType={EventData:x.QuickPulseDocumentType.Event,ExceptionData:x.QuickPulseDocumentType.Exception,MessageData:x.QuickPulseDocumentType.Trace,MetricData:x.QuickPulseDocumentType.Metric,RequestData:x.QuickPulseDocumentType.Request,RemoteDependencyData:x.QuickPulseDocumentType.Dependency,AvailabilityData:x.QuickPulseDocumentType.Availability,PageViewData:x.QuickPulseDocumentType.PageView};x.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"};x.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"};x.HeartBeatMetricName="HeartBeat";var be});var Yn=d((IE,Xu)=>{"use strict";var Kn=require("os"),ge=We(),og=function(){function e(t,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=Kn.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalRequestExecutionTime+=n,r===!1&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalDependencyExecutionTime+=n,r===!1&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var t=Kn.cpus();if(t&&t.length&&this._lastCpus&&t.length===this._lastCpus.length){for(var r=0,n=0,i=0,s=0,a=0,o=0;!!t&&o<t.length;o++){var c=t[o],u=this._lastCpus[o],l="% cpu("+o+") ",p=c.model,f=c.speed,v=c.times,m=u.times,b=v.user-m.user||0;r+=b;var k=v.sys-m.sys||0;n+=k;var O=v.nice-m.nice||0;i+=O;var g=v.idle-m.idle||0;s+=g;var D=v.irq-m.irq||0;a+=D}var K=void 0;if(typeof process.cpuUsage=="function"){var z=process.cpuUsage(),se=process.hrtime(),rr=z.user-this._lastAppCpuUsage.user+(z.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var yi=(se[0]-this._lastHrtime[0])*1e6+(se[1]-this._lastHrtime[1])/1e3||0;K=100*rr/(yi*t.length)}this._lastAppCpuUsage=z,this._lastHrtime=se}var et=r+n+i+s+a||1;this._client.trackMetric({name:ge.PerformanceCounter.PROCESSOR_TIME,value:(et-s)/et*100}),this._client.trackMetric({name:ge.PerformanceCounter.PROCESS_TIME,value:K||r/et*100})}this._lastCpus=t},e.prototype._trackMemory=function(){var t=Kn.freemem(),r=process.memoryUsage().rss,n=Kn.totalmem()-t;this._client.trackMetric({name:ge.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:ge.PerformanceCounter.AVAILABLE_BYTES,value:t}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:ge.QuickPulseCounter.COMMITTED_BYTES,value:n})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,s>0){var c=n/a,u=i/a;this._client.trackMetric({name:ge.PerformanceCounter.REQUEST_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:ge.PerformanceCounter.REQUEST_DURATION,value:o}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:ge.QuickPulseCounter.REQUEST_FAILURE_RATE,value:u})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,s>0){var c=n/a,u=i/a;this._client.trackMetric({name:ge.QuickPulseCounter.DEPENDENCY_RATE,value:c}),this._client.trackMetric({name:ge.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:ge.QuickPulseCounter.DEPENDENCY_DURATION,value:o})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time,s=i/1e3;if(i>0){var a=n/s;this._client.trackMetric({name:ge.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._lastRequestExecutionTime=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._lastDependencyExecutionTime=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();Xu.exports=og});var Mr=d((xE,Zu)=>{"use strict";var He=require("os"),Ku=require("fs"),Yu=require("path"),cg=oe(),Ju=G(),ug=function(){function e(t){this.keys=new cg.ContextTagKeys,this.tags={},this._loadApplicationContext(t),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||Yu.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(Ku.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.appVersion[t]=r.version)}catch(n){Ju.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=He&&He.hostname(),this.tags[this.keys.deviceOSVersion]=He&&He.type()+" "+He.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=He&&He.arch(),this.tags["ai.device.osPlatform"]=He&&He.platform()},e.prototype._loadInternalContext=function(){var t=Yu.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(Ku.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.sdkVersion=r.version)}catch(n){Ju.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();Zu.exports=ug});var tl=d((sa,el)=>{"use strict";var lg=sa&&sa.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ie=require("url"),ia=oe(),pg=le(),fg=Ot(),dg=_s(),hg=lt(),vg=function(e){lg(t,e);function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return t.prototype.onError=function(r){this._setStatus(void 0,r)},t.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=pg.getCorrelationContextTarget(r,fg.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(r,n){var i=Ie.parse(this.url);i.search=void 0,i.hash=void 0;var s=this.method.toUpperCase()+" "+i.pathname,a=ia.RemoteDependencyDataConstants.TYPE_HTTP,o=i.hostname;i.port&&(o+=":"+i.port),this.correlationId?(a=ia.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==hg.correlationIdPrefix&&(o+=" | "+this.correlationId)):a=ia.RemoteDependencyDataConstants.TYPE_HTTP;var c={id:n,name:s,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:a,target:o};if(r&&r.time?c.time=r.time:this.startTime&&(c.time=new Date(this.startTime)),r){for(var u in r)c[u]||(c[u]=r[u]);if(r.properties)for(var u in r.properties)c.properties[u]=r.properties[u]}return c},t._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)r=Ie.parse(r);else{var i=Ie.parse(r);i.host==="443"?r=Ie.parse("https://"+r):r=Ie.parse("http://"+r)}else{if(r&&typeof Ie.URL=="function"&&r instanceof Ie.URL)return Ie.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(c){r[c]=s[c]})}if(r.path){var a=Ie.parse(r.path);r.pathname=a.pathname,r.search=a.search}if(r.host&&r.port){var o=Ie.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",Ie.format(r)},t}(dg);el.exports=vg});var nl=d(Lr=>{"use strict";var rl=Lr&&Lr.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Lr,"__esModule",{value:!0});var gg=ln(),ue=We();function aa(e){var t=rl({},e);return Object.keys(ue.SpanAttribute).forEach(function(r){delete t[r]}),t}function mg(e){var t="|"+e.context().traceId+"."+e.context().spanId+".",r=Math.round(e._duration[0]*1e3+e._duration[1]/1e6),n=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",i=e.attributes.component?e.attributes.component.toString():"",s=i.toUpperCase()===ue.DependencyTypeName.Http||!!e.attributes[ue.SpanAttribute.HttpUrl],a=i.toLowerCase()===ue.DependencyTypeName.Grpc;if(s){var o=e.attributes[ue.SpanAttribute.HttpMethod]||"GET",c=new URL(e.attributes[ue.SpanAttribute.HttpUrl].toString()),u=e.attributes[ue.SpanAttribute.HttpHost]||c.host,l=e.attributes[ue.SpanAttribute.HttpPort]||c.port||null,p=c.pathname||"/",f=o+" "+p,v=ue.DependencyTypeName.Http,m=l?(u+":"+l).toString():u.toString(),b=c.toString(),k=e.attributes[ue.SpanAttribute.HttpStatusCode]||e.status.code||0,O=k<400;return{id:t,name:f,dependencyTypeName:v,target:m,data:b,success:O,duration:r,url:b,resultCode:String(k),properties:aa(e.attributes)}}else if(a){var o=e.attributes[ue.SpanAttribute.GrpcMethod]||"rpc",g=e.attributes[ue.SpanAttribute.GrpcService],D=g?o+" "+g:e.name;return{id:t,duration:r,name:D,target:g.toString(),data:g.toString()||D,url:g.toString()||D,dependencyTypeName:ue.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:e.status.code===0,properties:aa(e.attributes)}}else{var K=e.name,z=e.links&&e.links.map(function(se){return{operation_Id:se.context.traceId,id:se.context.spanId}});return{id:t,duration:r,name:K,target:n,data:n||K,url:n||K,dependencyTypeName:e.kind===gg.SpanKind.INTERNAL?ue.DependencyTypeName.InProc:i||e.name,resultCode:String(e.status.code||0),success:e.status.code===0,properties:rl({},aa(e.attributes),{"_MS.links":z||void 0})}}}Lr.spanToTelemetryContract=mg});var sl=d(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});var il=U(),_g=Cr(),yg=nl(),Jn=ln(),Ut=[];jt.subscriber=function(e){var t=e.data,r=yg.spanToTelemetryContract(t),n=t.context(),i=new _g;i.traceId=n.traceId,i.spanId=n.spanId,i.traceFlag=n.traceFlags.toString(),i.parentId=t.parentSpanId?"|"+n.traceId+"."+t.parentSpanId+".":null,Jn.AsyncScopeManager.with(t,function(){Ut.forEach(function(s){t.kind===Jn.SpanKind.SERVER?s.trackRequest(r):(t.kind===Jn.SpanKind.CLIENT||t.kind===Jn.SpanKind.INTERNAL)&&s.trackDependency(r)})})};function Eg(e,t){e?(Ut.length===0&&il.channel.subscribe("azure-coretracing",jt.subscriber),Ut.push(t)):(Ut=Ut.filter(function(r){return r!=t}),Ut.length===0&&il.channel.unsubscribe("azure-coretracing",jt.subscriber))}jt.enable=Eg});var ol=d(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});var al=U(),$t=[];Vt.subscriber=function(e){e.data.event.commandName!=="ismaster"&&$t.forEach(function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})})};function Cg(e,t){e?($t.length===0&&al.channel.subscribe("mongodb",Vt.subscriber),$t.push(t)):($t=$t.filter(function(r){return r!=t}),$t.length===0&&al.channel.unsubscribe("mongodb",Vt.subscriber))}Vt.enable=Cg});var ul=d(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});var cl=U(),Bt=[];Gt.subscriber=function(e){Bt.forEach(function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,s=r._connection||{},a=s.config||{},o=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})})};function Tg(e,t){e?(Bt.length===0&&cl.channel.subscribe("mysql",Gt.subscriber),Bt.push(t)):(Bt=Bt.filter(function(r){return r!=t}),Bt.length===0&&cl.channel.unsubscribe("mysql",Gt.subscriber))}Gt.enable=Tg});var pl=d(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ll=U(),zt=[];Qt.subscriber=function(e){zt.forEach(function(t){e.data.commandObj.command!=="info"&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})})};function bg(e,t){e?(zt.length===0&&ll.channel.subscribe("redis",Qt.subscriber),zt.push(t)):(zt=zt.filter(function(r){return r!=t}),zt.length===0&&ll.channel.unsubscribe("redis",Qt.subscriber))}Qt.enable=bg});var dl=d(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});var fl=U(),Wt=[];Xt.subscriber=function(e){Wt.forEach(function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,s=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:s,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})})};function Ig(e,t){e?(Wt.length===0&&fl.channel.subscribe("postgres",Xt.subscriber),Wt.push(t)):(Wt=Wt.filter(function(r){return r!=t}),Wt.length===0&&fl.channel.unsubscribe("postgres",Xt.subscriber))}Xt.enable=Ig});var Yt=d((qE,ml)=>{"use strict";var yt=require("http"),Kt=require("https"),oa=G(),hl=le(),Xe=Ot(),xg=tl(),vl=it(),gl=lt(),ca=Cr(),wg=Sn(),Sg=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,this._isEnabled&&!this._isInitialized&&this._initialize(),wg.IsInitialized&&(sl().enable(!0,this._client),ol().enable(t,this._client),ul().enable(t,this._client),pl().enable(t,this._client),dl().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=yt.get,n=yt.request,i=Kt.request,s=function(a,o){var c=!o[e.disableCollectionRequestOption]&&!a[e.alreadyAutoCollectedFlag];o.headers&&o.headers["user-agent"]&&o.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(c=!1),a[e.alreadyAutoCollectedFlag]=!0,a&&o&&c&&(vl.CorrelationContextManager.wrapEmitter(a),e.trackRequest(t._client,{options:o,request:a}))};yt.request=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];var u=n.call.apply(n,[yt,a].concat(o));return s(u,a),u},Kt.request=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];var u=i.call.apply(i,[Kt,a].concat(o));return s(u,a),u},yt.get=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];var u=(l=yt.request).call.apply(l,[yt,a].concat(o));return u.end(),u;var l},Kt.get=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];var u=(l=Kt.request).call.apply(l,[Kt,a].concat(o));return u.end(),u;var l}},e.trackRequest=function(t,r){if(!r.options||!r.request||!t){oa.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t);return}var n=new xg(r.options,r.request),i=vl.CorrelationContextManager.getCurrentContext(),s,a;if(i&&i.operation&&i.operation.traceparent&&ca.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),s=i.operation.traceparent.getBackCompatRequestId();else if(gl.w3cEnabled){var o=new ca;a=o.toString(),s=o.getBackCompatRequestId()}else s=i&&i.operation&&i.operation.parentId+e.requestNumber+++".";if(hl.canIncludeCorrelationHeader(t,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var c=r.request.getHeader(Xe.requestContextHeader);try{hl.safeIncludeCorrelationHeader(t,r.request,c)}catch(p){oa.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(i&&i.operation)try{if(r.request.setHeader(Xe.requestIdHeader,s),t.config.ignoreLegacyHeaders||(r.request.setHeader(Xe.parentIdHeader,i.operation.id),r.request.setHeader(Xe.rootIdHeader,s)),a||i.operation.traceparent)r.request.setHeader(Xe.traceparentHeader,a||i.operation.traceparent.toString());else if(gl.w3cEnabled){var o=new ca().toString();r.request.setHeader(Xe.traceparentHeader,o)}if(i.operation.tracestate){var u=i.operation.tracestate.toString();u&&r.request.setHeader(Xe.traceStateHeader,u)}var l=i.customProperties.serializeToHeader();l&&r.request.setHeader(Xe.correlationContextHeader,l)}catch(p){oa.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}r.request.on&&(r.request.on("response",function(p){n.onResponse(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=p,t.trackDependency(f)}),r.request.on("error",function(p){n.onError(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=p,t.trackDependency(f)}))},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();ml.exports=Sg});var El=d((OE,yl)=>{"use strict";var Dg=require("os"),_l=We(),Ag=le(),Pg=Mr(),Rg=Yt(),qg="http://169.254.169.254/metadata/instance/compute",Og="api-version=2017-12-01",Ng="format=json",kg="ENETUNREACH",Mg=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._handle=setInterval(function(){return n.trackHeartBeat(r,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(t,r){var n=this,i=!1,s={},a=Pg.sdkVersion;s.sdk=a,s.osType=Dg.type(),process.env.WEBSITE_SITE_NAME?(s.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",s.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",s.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?s.azfunction_appId=process.env.WEBSITE_HOSTNAME:t&&(this._isVM===void 0?(i=!0,this._getAzureComputeMetadata(t,function(){n._isVM&&Object.keys(n._vmData).length>0&&(s.azInst_vmId=n._vmData.vmId||"",s.azInst_subscriptionId=n._vmData.subscriptionId||"",s.azInst_osType=n._vmData.osType||"",n._azInst_vmId=n._vmData.vmId||"",n._azInst_subscriptionId=n._vmData.subscriptionId||"",n._azInst_osType=n._vmData.osType||""),n._client.trackMetric({name:_l.HeartBeatMetricName,value:0,properties:s}),r()})):this._isVM&&(s.azInst_vmId=this._azInst_vmId,s.azInst_subscriptionId=this._azInst_subscriptionId,s.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:_l.HeartBeatMetricName,value:0,properties:s}),r())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(t,r){var n=this,i=qg+"?"+Og+"&"+Ng,s=(o={method:"GET"},o[Rg.disableCollectionRequestOption]=!0,o.headers={Metadata:"True"},o),a=Ag.makeRequest(t,i,s,function(c){if(c.statusCode===200){n._isVM=!0;var u="";c.on("data",function(l){u+=l}),c.on("end",function(){n._vmData=n._isJSON(u)?JSON.parse(u):{},r()})}else r()});a&&(a.on("error",function(c){c&&c.message&&c.message.indexOf(kg)>-1&&(n._isVM=!1),r()}),a.end());var o},e.prototype._isJSON=function(t){try{return JSON.parse(t)&&!!t}catch{return!1}},e}();yl.exports=Mg});var la=d((NE,xl)=>{"use strict";var Cl=require("http"),Tl=require("https"),bl=G(),Il=le(),Lg=Ot(),ua=Cs(),Fe=it(),Hg=Yn(),Fg=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,(this._isAutoCorrelating||this._isEnabled||Hg.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(t,r){t&&!this._isAutoCorrelating?Fe.CorrelationContextManager.enable(r):!t&&this._isAutoCorrelating&&Fe.CorrelationContextManager.disable(),this._isAutoCorrelating=t},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(t){if(!!this._isAutoCorrelating)return Fe.CorrelationContextManager.generateContextObject(t.getOperationId(this._client.context.tags),t.getRequestId(),t.getOperationName(this._client.context.tags),t.getCorrelationContextHeader(),t.getTraceparent(),t.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(a){if(!!a){if(typeof a!="function")throw new Error("onRequest handler must be a function");return function(o,c){Fe.CorrelationContextManager.wrapEmitter(o),Fe.CorrelationContextManager.wrapEmitter(c);var u=o&&!o[e.alreadyAutoCollectedFlag];if(o&&u){var l=new ua(o),p=t._generateCorrelationContext(l);Fe.CorrelationContextManager.runWithContext(p,function(){t._isEnabled&&(o[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:o,response:c},l)),typeof a=="function"&&a(o,c)})}else typeof a=="function"&&a(o,c)}}},n=function(a){var o=a.addListener.bind(a);a.addListener=function(c,u){switch(c){case"request":case"checkContinue":return o(c,r(u));default:return o(c,u)}},a.on=a.addListener},i=Cl.createServer;Cl.createServer=function(a,o){if(o&&typeof o=="function"){var c=i(a,r(o));return n(c),c}else{var c=i(r(a));return n(c),c}};var s=Tl.createServer;Tl.createServer=function(a,o){var c=s(a,r(o));return n(c),c}},e.trackRequestSync=function(t,r){if(!r.request||!r.response||!t){bl.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t);return}e.addResponseCorrelationIdHeader(t,r.response);var n=Fe.CorrelationContextManager.getCurrentContext(),i=new ua(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)},e.trackRequest=function(t,r,n){if(!r.request||!r.response||!t){bl.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t);return}var i=Fe.CorrelationContextManager.getCurrentContext(),s=n||new ua(r.request,i&&i.operation.parentId);Il.canIncludeCorrelationHeader(t,s.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=s.getOperationId(t.context.tags)||i.operation.id,i.operation.name=s.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=s.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){e.endRequest(t,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){e.endRequest(t,s,r,null,a)})},e.addResponseCorrelationIdHeader=function(t,r){if(t.config&&t.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(Lg.requestContextHeader);Il.safeIncludeCorrelationHeader(t,r,n)}},e.endRequest=function(t,r,n,i,s){s?r.onError(s,i):r.onResponse(n.response,i);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(t.context.tags),n.tagOverrides)for(var o in n.tagOverrides)a.tagOverrides[o]=n.tagOverrides[o];var c=r.getLegacyRootId();c&&(a.properties.ai_legacyRootId=c),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,t.trackRequest(a)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,Fe.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();xl.exports=Fg});var Dl=d((kE,Sl)=>{"use strict";var wl=We(),Ug=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var o=a.split(e._FIELD_KEY_VALUE_SEPARATOR);if(o.length===2){var c=o[0].toLowerCase(),u=o[1];s[c]=u}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||wl.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||wl.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();Sl.exports=Ug});var Zn=d((ME,Rl)=>{"use strict";var pa=lt(),Al=Dl(),jg=G(),Pl=We(),$g=require("url"),Vg=function(){function e(t){var r=this;this.endpointBase=Pl.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],i=Al.parse(t),s=Al.parse(n),a=!i.instrumentationkey&&Object.keys(i).length>0?null:t;this.instrumentationKey=i.instrumentationkey||a||s.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey)||jg.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this.endpointUrl=(i.ingestionendpoint||s.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(o){return r.correlationId=o},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||s.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||s.liveendpoint||process.env[e.ENV_quickPulseHost]||Pl.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=$g.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(t){pa.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=t,this.correlationId=pa.correlationIdPrefix,pa.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(t){this._quickPulseHost=t},enumerable:!0,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||t=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(t){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(t)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();Rl.exports=Vg});var Nl=d((da,Ol)=>{"use strict";var Hr=da&&da.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},fa=require("os"),Et=oe(),ql=We(),Bg=le(),Gg=G(),zg=Bg.w3cTraceId(),Qg=function(){function e(){}return e.createQuickPulseEnvelope=function(t,r,n,i){var s=fa&&typeof fa.hostname=="function"&&fa.hostname()||"Unknown",a=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||s,o={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:t.length>0?t:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:zg,MachineName:s,Instance:a};return o},e.createQuickPulseMetric=function(t){var r;return r={Name:t.name,Value:t.value,Weight:t.count||1},r},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case Et.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case Et.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case Et.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case Et.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case Et.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.name,i=Hr({},r,{Name:n});return i},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.severityLevel||0,i=Hr({},r,{Message:t.data.baseData.message,SeverityLevel:Et.SeverityLevel[n]});return i},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.exceptions,i="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(c){i+=c.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),s=n[0].message,a=n[0].typeName);var o=Hr({},r,{Exception:i,ExceptionMessage:s,ExceptionType:a});return o},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Hr({},r,{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Hr({},r,{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},e.createQuickPulseDocument=function(t){var r,n,i,s;t.data.baseType?(n=ql.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=ql.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):Gg.warn("Document type invalid; not sending live metric document",t.data.baseType),i=t.tags[e.keys.operationId],s=e.aggregateProperties(t);var a={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:s};return a},e.aggregateProperties=function(t){var r=[],n=t.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],a={key:i,value:s};r.push(a)}var o=t.data.baseData.properties||{};for(var i in o)if(o.hasOwnProperty(i)){var s=o[i],a={key:i,value:s};r.push(a)}return r},e.keys=new Et.ContextTagKeys,e}();Ol.exports=Qg});var Ml=d((LE,kl)=>{"use strict";var Wg=function(){return(Date.now()+621355968e5)*1e4};kl.exports={getTransmissionTime:Wg}});var Fl=d((HE,Hl)=>{"use strict";var Xg=require("https"),Kg=Yt(),Ll=G(),Yg=Ml(),Jg=le(),ha={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},Zg=function(){function e(t){this._config=t,this._consecutiveErrors=0}return e.prototype.ping=function(t,r){this._submitData(t,r,"ping")},e.prototype.post=function(t,r){this._submitData([t],r,"post")},e.prototype._submitData=function(t,r,n){var i=this,s=JSON.stringify(t),a=(c={},c[Kg.disableCollectionRequestOption]=!0,c.host=this._config.quickPulseHost,c.method=ha.method,c.path="/QuickPulseService.svc/"+n+"?ikey="+this._config.instrumentationKey,c.headers=(u={Expect:"100-continue"},u[ha.time]=Yg.getTransmissionTime(),u["Content-Type"]="application/json",u["Content-Length"]=Buffer.byteLength(s),u),c);this._config.httpsAgent?a.agent=this._config.httpsAgent:a.agent=Jg.tlsRestrictedAgent;var o=Xg.request(a,function(l){var p=l.headers[ha.subscribed]==="true";i._consecutiveErrors=0,r(p,l)});o.on("error",function(l){i._consecutiveErrors++;var p="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";i._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN===0?(p="Live Metrics endpoint could not be reached "+i._consecutiveErrors+" consecutive times. Most recent error:",Ll.warn(e.TAG,p,l)):Ll.info(e.TAG,p,l),r()}),o.write(s),o.end();var c,u},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();Hl.exports=Zg});var jl=d((FE,Ul)=>{"use strict";var em=G(),tm=Zn(),va=Nl(),rm=Fl(),nm=We(),im=Mr(),sm=function(){function e(t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new tm(t),this.context=r||new im,this._sender=new rm(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(t){this._collectors.push(t)},e.prototype.trackMetric=function(t){this._addMetric(t)},e.prototype.addDocument=function(t){var r=va.telemetryEnvelopeToQuickPulseDocument(t);r&&this._documents.push(r)},e.prototype.enable=function(t){t&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!t&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(t){this._collectors.forEach(function(r){r.enable(t)})},e.prototype._addMetric=function(t){var r=t.value,n=t.count||1,i=nm.PerformanceToQuickPulseCounter[t.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=va.createQuickPulseMetric(t),this._metrics[i].Name=i,this._metrics[i].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){var t=this,r=Object.keys(this._metrics).map(function(s){return t._metrics[s]}),n=va.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var i=this._isCollectingData?e.POST_INTERVAL:e.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref()},e.prototype._ping=function(t){this._sender.ping(t,this._quickPulseDone.bind(this))},e.prototype._post=function(t){this._sender.post(t,this._quickPulseDone.bind(this))},e.prototype._quickPulseDone=function(t,r){t!=null?(this._isCollectingData!==t&&(em.info("Live Metrics sending data",t),this.enableCollectors(t)),this._isCollectingData=t,r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();Ul.exports=sm});var Vl=d(Ur=>{"use strict";var am=Ur&&Ur.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Ur,"__esModule",{value:!0});var $l=Zn(),Fr=Mr(),om=G(),cm=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>=6},e.prototype.enable=function(t,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!e.isNodeVersionCompatible()){if(e._metricsAvailable==null&&t&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");e._emitter=new s,e._metricsAvailable=!0,om.info("Native metrics module successfully loaded!")}catch{e._metricsAvailable=!1;return}this._isEnabled=t,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,n),this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref()):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(t){var r=process.env[$l.ENV_nativeMetricsDisableAll],n=process.env[$l.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),s={};if(i.length>0)for(var a=0,o=i;a<o.length;a++){var c=o[a];s[c]=!0}return typeof t=="object"?{isEnabled:!0,disabledMetrics:am({},t,s)}:{isEnabled:t,disabledMetrics:s}}return typeof t=="boolean"?{isEnabled:t,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:t}},e.prototype._trackNativeMetrics=function(){var t=!0;typeof this._isEnabled!="object"&&(t=this._isEnabled),t&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var t=e._emitter.getGCData();for(var r in t){var n=t[r].metrics,i=r+" Garbage Collection Duration",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,max:n.max,min:n.min,stdDev:s,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Fr.sdkVersion,a)})}var a}},e.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var t=e._emitter.getLoopData(),r=t.loopUsage;if(r.count!=0){var n="Event Loop CPU Time",i=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:n,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:i,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Fr.sdkVersion,s)});var s}}},e.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var t=process.memoryUsage(),r=t.heapUsed,n=t.heapTotal,i=t.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:r,count:1,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Fr.sdkVersion,s)}),this._client.trackMetric({name:"Memory Total (Heap)",value:n,count:1,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Fr.sdkVersion,a)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:i-n,count:1,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+Fr.sdkVersion,o)});var s,a,o}},e}();Ur.AutoCollectNativePerformance=cm});var zl=d((jE,Gl)=>{"use strict";var Bl=G(),um=function(){function e(t,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=t,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return e.prototype.setUseDiskRetryCaching=function(t,r,n){this._sender.setDiskRetryMode(t,r,n)},e.prototype.send=function(t){var r=this;if(!this._isDisabled()){if(!t){Bl.warn("Cannot send null/undefined telemetry");return}var n=this._stringify(t);if(typeof n=="string"){if(this._buffer.push(n),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}}},e.prototype.triggerSend=function(t,r){var n=this._buffer.length<1;if(!n){var i=this._buffer.join(`
`);t?(this._sender.saveOnCrash(i),typeof r=="function"&&r("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(i):new Buffer(i),r)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},e.prototype._stringify=function(t){try{return JSON.stringify(t)}catch(r){Bl.warn("Failed to serialize payload",r,t)}},e}();Gl.exports=um});var Ql=d(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});function lm(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}ga.azureRoleEnvironmentTelemetryProcessor=lm});var Kl=d(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});var Wl=oe();function pm(e,t){var r=e.sampleRate,n=!1;return r==null||r>=100||e.data&&Wl.TelemetryType.Metric===Wl.baseTypeToTelemetryType(e.data.baseType)?!0:(t.correlationContext&&t.correlationContext.operation?n=Xl(t.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}ei.samplingTelemetryProcessor=pm;function Xl(e){var t=-2147483648,r=2147483647,n=5381;if(!e)return 0;for(;e.length<8;)e=e+e;for(var i=0;i<e.length;i++)n=((n<<5)+n|0)+e.charCodeAt(i)|0;return n=n<=t?r:Math.abs(n),n/r*100}ei.getSamplingHashCode=Xl});var Yl=d(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});var ma=Yn(),_a=oe();function fm(e,t){switch(t&&t.addDocument(e),e.data.baseType){case _a.TelemetryTypeString.Exception:ma.countException();break;case _a.TelemetryTypeString.Request:var r=e.data.baseData;ma.countRequest(r.duration,r.success);break;case _a.TelemetryTypeString.Dependency:var n=e.data.baseData;ma.countDependency(n.duration,n.success);break}return!0}ya.performanceMetricsTelemetryProcessor=fm});var Jl=d(ti=>{"use strict";function Ea(e){for(var t in e)ti.hasOwnProperty(t)||(ti[t]=e[t])}Object.defineProperty(ti,"__esModule",{value:!0});Ea(Ql());Ea(Kl());Ea(Yl())});var ep=d((zE,Zl)=>{"use strict";var ne=require("fs"),ri=require("os"),Ue=require("path"),dm=require("zlib"),Jt=require("child_process"),ee=G(),hm=Yt(),vm=le(),gm=function(){function e(t,r,n){if(this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._resendTimer=null,!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=ne.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||ee.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,ee.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},e.prototype.send=function(t,r){var n=this,i=this._config.endpointUrl,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};dm.gzip(t,function(a,o){var c=o;a?(ee.warn(a),c=t,s.headers["Content-Length"]=t.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=o.length),ee.info(e.TAG,s),s[hm.disableCollectionRequestOption]=!0;var u=function(p){p.setEncoding("utf-8");var f="";p.on("data",function(v){f+=v}),p.on("end",function(){n._numConsecutiveFailures=0,ee.info(e.TAG,f),typeof n._onSuccess=="function"&&n._onSuccess(f),typeof r=="function"&&r(f),n._enableDiskRetryMode&&(p.statusCode===200?n._resendTimer||(n._resendTimer=setTimeout(function(){n._resendTimer=null,n._sendFirstFileOnDisk()},n._resendInterval),n._resendTimer.unref()):(p.statusCode===408||p.statusCode===429||p.statusCode===439||p.statusCode===500||p.statusCode===503)&&n._storeToDisk(t))})},l=vm.makeRequest(n._config,i,s,u);l.on("error",function(p){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var f="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(f="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),ee.warn(e.TAG,f,p)}else{var f="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";ee.info(e.TAG,f,p)}if(n._onErrorHelper(p),typeof r=="function"){var v="error sending telemetry";p&&typeof p.toString=="function"&&(v=p.toString()),r(v)}n._enableDiskRetryMode&&n._storeToDisk(t)}),l.write(c),l.end()})},e.prototype.saveOnCrash=function(t){this._enableDiskRetryMode&&this._storeToDiskSync(t)},e.prototype._runICACLS=function(t,r){var n=Jt.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,s){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},e.prototype._runICACLSSync=function(t){if(Jt.spawnSync){var r=Jt.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=Jt.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return t(i,null)}),r.on("close",function(i,s){return e.ACL_IDENTITY=n&&n.trim(),t(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),e.ACL_IDENTITY)})},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(Jt.spawnSync){var t=Jt.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(t.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(t,r){return[t,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;if(!e.USE_ICACLS)return r(null);if(e.ACLED_DIRECTORIES[t]===void 0)e.ACLED_DIRECTORIES[t]=!1,this._getACLIdentity(function(i,s){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,s),function(a){return e.ACLED_DIRECTORIES[t]=!a,r(a)})});else return r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(e.ACLED_DIRECTORIES[t]===void 0){this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),e.ACLED_DIRECTORIES[t]=!0;return}else if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(t,r){var n=this;ne.lstat(t,function(i,s){i&&i.code==="ENOENT"?ne.mkdir(t,function(a){a&&a.code!=="EEXIST"?r(a):n._applyACLRules(t,r)}):!i&&s.isDirectory()?n._applyACLRules(t,r):r(i||new Error("Path existed but was not a directory"))})},e.prototype._getShallowDirectorySize=function(t,r){ne.readdir(t,function(n,i){if(n)return r(n,-1);var s=null,a=0,o=0;if(i.length===0){r(null,0);return}for(var c=0;c<i.length;c++)ne.stat(Ue.join(t,i[c]),function(u,l){o++,u?s=u:l.isFile()&&(a+=l.size),o===i.length&&(s?r(s,-1):r(s,a))})})},e.prototype._getShallowDirectorySizeSync=function(t){for(var r=ne.readdirSync(t),n=0,i=0;i<r.length;i++)n+=ne.statSync(Ue.join(t,r[i])).size;return n},e.prototype._storeToDisk=function(t){var r=this,n=Ue.join(ri.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);ee.info(e.TAG,"Checking existence of data storage directory: "+n),this._confirmDirExists(n,function(i){if(i){ee.warn(e.TAG,"Error while checking/creating directory: "+(i&&i.message)),r._onErrorHelper(i);return}r._getShallowDirectorySize(n,function(s,a){if(s||a<0){ee.warn(e.TAG,"Error while checking directory size: "+(s&&s.message)),r._onErrorHelper(s);return}else if(a>r._maxBytesOnDisk){ee.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);return}var o=new Date().getTime()+".ai.json",c=Ue.join(n,o);ee.info(e.TAG,"saving data to disk at: "+c),ne.writeFile(c,t,{mode:384},function(u){return r._onErrorHelper(u)})})})},e.prototype._storeToDiskSync=function(t){var r=Ue.join(ri.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);try{ee.info(e.TAG,"Checking existence of data storage directory: "+r),ne.existsSync(r)||ne.mkdirSync(r),this._applyACLRulesSync(r);var n=this._getShallowDirectorySizeSync(r);if(n>this._maxBytesOnDisk){ee.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+n);return}var i=new Date().getTime()+".ai.json",s=Ue.join(r,i);ee.info(e.TAG,"saving data before crash to disk at: "+s),ne.writeFileSync(s,t,{mode:384})}catch(a){ee.warn(e.TAG,"Error while saving data to disk: "+(a&&a.message)),this._onErrorHelper(a)}},e.prototype._sendFirstFileOnDisk=function(){var t=this,r=Ue.join(ri.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);ne.exists(r,function(n){n&&ne.readdir(r,function(i,s){if(i)t._onErrorHelper(i);else if(s=s.filter(function(c){return Ue.basename(c).indexOf(".ai.json")>-1}),s.length>0){var a=s[0],o=Ue.join(r,a);ne.readFile(o,function(c,u){c?t._onErrorHelper(c):ne.unlink(o,function(l){l?t._onErrorHelper(l):t.send(u)})})}})})},e.prototype._onErrorHelper=function(t){typeof this._onError=="function"&&this._onError(t)},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=60*1e3,e.MAX_BYTES_ON_DISK=50*1e3*1e3,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS=ri.type()==="Windows_NT",e}();Zl.exports=gm});var np=d((QE,rp)=>{"use strict";var y=oe(),me=le(),mm=it(),_m=function(){function e(){}return e.createEnvelope=function(t,r,n,i,s){var a=null;switch(r){case y.TelemetryType.Trace:a=e.createTraceData(t);break;case y.TelemetryType.Dependency:a=e.createDependencyData(t);break;case y.TelemetryType.Event:a=e.createEventData(t);break;case y.TelemetryType.Exception:a=e.createExceptionData(t);break;case y.TelemetryType.Request:a=e.createRequestData(t);break;case y.TelemetryType.Metric:a=e.createMetricData(t);break;case y.TelemetryType.Availability:a=e.createAvailabilityData(t);break;case y.TelemetryType.PageView:a=e.createPageViewData(t);break}if(n&&y.domainSupportsProperties(a.baseData)){if(a&&a.baseData)if(!a.baseData.properties)a.baseData.properties=n;else for(var o in n)a.baseData.properties[o]||(a.baseData.properties[o]=n[o]);a.baseData.properties=me.validateStringMap(a.baseData.properties)}var c=s&&s.instrumentationKey||"",u=new y.Envelope;return u.data=a,u.iKey=c,u.name="Microsoft.ApplicationInsights."+c.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),u.tags=this.getTags(i,t.tagOverrides),u.time=new Date().toISOString(),u.ver=1,u.sampleRate=s?s.samplingPercentage:100,r===y.TelemetryType.Metric&&(u.sampleRate=100),u},e.createTraceData=function(t){var r=new y.MessageData;r.message=t.message,r.properties=t.properties,isNaN(t.severity)?r.severityLevel=y.SeverityLevel.Information:r.severityLevel=t.severity;var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Trace),n.baseData=r,n},e.createDependencyData=function(t){var r=new y.RemoteDependencyData;typeof t.name=="string"&&(r.name=t.name.length>1024?t.name.slice(0,1021)+"...":t.name),r.data=t.data,r.target=t.target,r.duration=me.msToTimeSpan(t.duration),r.success=t.success,r.type=t.dependencyTypeName,r.properties=t.properties,r.resultCode=t.resultCode?t.resultCode+"":"",t.id?r.id=t.id:r.id=me.w3cTraceId();var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Dependency),n.baseData=r,n},e.createEventData=function(t){var r=new y.EventData;r.name=t.name,r.properties=t.properties,r.measurements=t.measurements;var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Event),n.baseData=r,n},e.createExceptionData=function(t){var r=new y.ExceptionData;r.properties=t.properties,isNaN(t.severity)?r.severityLevel=y.SeverityLevel.Error:r.severityLevel=t.severity,r.measurements=t.measurements,r.exceptions=[];var n=t.exception.stack,i=new y.ExceptionDetails;i.message=t.exception.message,i.typeName=t.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=me.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var s=new y.Data;return s.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Exception),s.baseData=r,s},e.createRequestData=function(t){var r=new y.RequestData;t.id?r.id=t.id:r.id=me.w3cTraceId(),r.name=t.name,r.url=t.url,r.source=t.source,r.duration=me.msToTimeSpan(t.duration),r.responseCode=t.resultCode?t.resultCode+"":"",r.success=t.success,r.properties=t.properties;var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Request),n.baseData=r,n},e.createMetricData=function(t){var r=new y.MetricData;r.metrics=[];var n=new y.DataPoint;n.count=isNaN(t.count)?1:t.count,n.kind=y.DataPointType.Aggregation,n.max=isNaN(t.max)?t.value:t.max,n.min=isNaN(t.min)?t.value:t.min,n.name=t.name,n.stdDev=isNaN(t.stdDev)?0:t.stdDev,n.value=t.value,r.metrics.push(n),r.properties=t.properties;var i=new y.Data;return i.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Metric),i.baseData=r,i},e.createAvailabilityData=function(t){var r=new y.AvailabilityData;t.id?r.id=t.id:r.id=me.w3cTraceId(),r.name=t.name,r.duration=me.msToTimeSpan(t.duration),r.success=t.success,r.runLocation=t.runLocation,r.message=t.message,r.measurements=t.measurements,r.properties=t.properties;var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.Availability),n.baseData=r,n},e.createPageViewData=function(t){var r=new y.PageViewData;r.name=t.name,r.duration=me.msToTimeSpan(t.duration),r.url=t.url,r.measurements=t.measurements,r.properties=t.properties;var n=new y.Data;return n.baseType=y.telemetryTypeToBaseType(y.TelemetryType.PageView),n.baseData=r,n},e.getTags=function(t,r){var n=mm.CorrelationContextManager.getCurrentContext(),i={};if(t&&t.tags)for(var s in t.tags)i[s]=t.tags[s];if(r)for(var s in r)i[s]=r[s];return n&&(i[t.keys.operationId]=i[t.keys.operationId]||n.operation.id,i[t.keys.operationName]=i[t.keys.operationName]||n.operation.name,i[t.keys.operationParentId]=i[t.keys.operationParentId]||n.operation.parentId),i},e.parseStack=function(t){var r=void 0;if(typeof t=="string"){var n=t.split(`
`);r=[];for(var i=0,s=0,a=0;a<=n.length;a++){var o=n[a];if(tp.regex.test(o)){var c=new tp(n[a],i++);s+=c.sizeInBytes,r.push(c)}}var u=32*1024;if(s>u)for(var l=0,p=r.length-1,f=0,v=l,m=p;l<p;){var b=r[l].sizeInBytes,k=r[p].sizeInBytes;if(f+=b+k,f>u){var O=m-v+1;r.splice(v,O);break}v=l,m=p,l++,p--}}return r},e}(),tp=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=me.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=me.trim(n[2])||this.method,this.fileName=me.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();rp.exports=_m});var op=d((WE,ap)=>{"use strict";var ym=require("url"),Em=Zn(),Cm=Mr(),je=oe(),Tm=zl(),Ca=Jl(),ip=it(),bm=ep(),Im=le(),sp=G(),xm=np(),wm=function(){function e(t){this._telemetryProcessors=[],this._enableAzureProperties=!1;var r=new Em(t);this.config=r,this.context=new Cm,this.commonProperties={};var n=new bm(this.config);this.channel=new Tm(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return e.prototype.trackAvailability=function(t){this.track(t,je.TelemetryType.Availability)},e.prototype.trackPageView=function(t){this.track(t,je.TelemetryType.PageView)},e.prototype.trackTrace=function(t){this.track(t,je.TelemetryType.Trace)},e.prototype.trackMetric=function(t){this.track(t,je.TelemetryType.Metric)},e.prototype.trackException=function(t){t&&t.exception&&!Im.isError(t.exception)&&(t.exception=new Error(t.exception.toString())),this.track(t,je.TelemetryType.Exception)},e.prototype.trackEvent=function(t){this.track(t,je.TelemetryType.Event)},e.prototype.trackRequest=function(t){this.track(t,je.TelemetryType.Request)},e.prototype.trackDependency=function(t){t&&!t.target&&t.data&&(t.target=ym.parse(t.data).host),this.track(t,je.TelemetryType.Dependency)},e.prototype.flush=function(t){this.channel.triggerSend(t?!!t.isAppCrashing:!1,t?t.callback:void 0)},e.prototype.track=function(t,r){if(t&&je.telemetryTypeToBaseType(r)){var n=xm.createEnvelope(t,r,this.commonProperties,this.context,this.config);t.time&&(n.time=t.time.toISOString()),this._enableAzureProperties&&Ca.azureRoleEnvironmentTelemetryProcessor(n,this.context);var i=this.runTelemetryProcessors(n,t.contextObjects);i=i&&Ca.samplingTelemetryProcessor(n,{correlationContext:ip.CorrelationContextManager.getCurrentContext()}),i&&(Ca.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else sp.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(t){this._enableAzureProperties=t},e.prototype.addTelemetryProcessor=function(t){this._telemetryProcessors.push(t)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(t,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=ip.CorrelationContextManager.getCurrentContext();for(var s=0;s<i;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[t,r])===!1){n=!1;break}}catch(o){n=!0,sp.warn("One of telemetry processors failed, telemetry item will be sent.",o,t)}return n},e}();ap.exports=wm});var lp=d((Ta,up)=>{"use strict";var Sm=Ta&&Ta.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dm=op(),cp=la(),Am=Yt(),ni=G(),Pm=function(e){Sm(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?cp.trackRequestSync(this,r):ni.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&ni.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?cp.trackRequest(this,r):ni.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(r){r&&r.request?Am.trackRequest(this,r):ni.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(Dm);up.exports=Pm});var fp=d(pp=>{"use strict";Object.defineProperty(pp,"__esModule",{value:!0})});var qp=d(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});var ba=it(),Rm=zu(),qm=Wu(),hp=Yn(),Om=El(),Nm=Yt(),km=la(),vp=lt(),jr=G(),Mm=jl(),gp=Vl();_.TelemetryClient=lp();_.Contracts=oe();_.azureFunctionsTypes=fp();var mp;(function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"})(mp=_.DistributedTracingModes||(_.DistributedTracingModes={}));var _p=!0,yp=!1,Ep=!0,Cp=!0,Tp=!1,bp=!0,Ip=!0,xp=!0,Ia=!0,wp,ii=!1,Sp=!0,Dp,Ap=void 0,Pp=void 0,$r,Vr,Br,Gr,Zt,Ct,zr,$e=!1,dp;function Lm(e){return _.defaultClient?jr.info("The default client is already setup"):(_.defaultClient=new _.TelemetryClient(e),$r=new Rm(_.defaultClient),Vr=new qm(_.defaultClient),Br=new hp(_.defaultClient),Gr=new Om(_.defaultClient),Ct=new km(_.defaultClient),zr=new Nm(_.defaultClient),Zt||(Zt=new gp.AutoCollectNativePerformance(_.defaultClient))),_.defaultClient&&_.defaultClient.channel&&_.defaultClient.channel.setUseDiskRetryCaching(xp,Ap,Pp),xa}_.setup=Lm;function Rp(){return _.defaultClient?($e=!0,$r.enable(_p,yp),Vr.enable(Ep),Br.enable(Cp),Gr.enable(Tp,_.defaultClient.config),Zt.enable(Sp,Dp),Ct.useAutoCorrelation(Ia,wp),Ct.enable(bp),zr.enable(Ip),_.liveMetricsClient&&ii&&_.liveMetricsClient.enable(ii)):jr.warn("Start cannot be called before setup"),xa}_.start=Rp;function Hm(){return Ia?ba.CorrelationContextManager.getCurrentContext():null}_.getCorrelationContext=Hm;function Fm(e,t){return ba.CorrelationContextManager.startOperation(e,t)}_.startOperation=Fm;function Um(e,t){return ba.CorrelationContextManager.wrapCallback(e,t)}_.wrapWithCorrelationContext=Um;var xa=function(){function e(){}return e.setDistributedTracingMode=function(t){return vp.w3cEnabled=t===mp.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return r===void 0&&(r=!1),_p=t,yp=r,$e&&$r.enable(t,r),e},e.setAutoCollectExceptions=function(t){return Ep=t,$e&&Vr.enable(t),e},e.setAutoCollectPerformance=function(t,r){r===void 0&&(r=!0),Cp=t;var n=gp.AutoCollectNativePerformance.parseEnabled(r);return Sp=n.isEnabled,Dp=n.disabledMetrics,$e&&(Br.enable(t),Zt.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectHeartbeat=function(t){return Tp=t,$e&&Gr.enable(t,_.defaultClient.config),e},e.setAutoCollectRequests=function(t){return bp=t,$e&&Ct.enable(t),e},e.setAutoCollectDependencies=function(t){return Ip=t,$e&&zr.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return Ia=t,wp=r,$e&&Ct.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(t,r,n){return xp=t,Ap=r,Pp=n,_.defaultClient&&_.defaultClient.channel&&_.defaultClient.channel.setUseDiskRetryCaching(t,r,n),e},e.setInternalLogging=function(t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),jr.enableDebug=t,jr.disableWarnings=!r,e},e.setSendLiveMetrics=function(t){return t===void 0&&(t=!1),_.defaultClient?(!_.liveMetricsClient&&t?(_.liveMetricsClient=new Mm(_.defaultClient.config.instrumentationKey),dp=new hp(_.liveMetricsClient,1e3,!0),_.liveMetricsClient.addCollector(dp),_.defaultClient.quickPulseClient=_.liveMetricsClient):_.liveMetricsClient&&_.liveMetricsClient.enable(t),ii=t,e):(jr.warn("Live metrics client cannot be setup without the default client"),e)},e.start=Rp,e}();_.Configuration=xa;function jm(){vp.w3cEnabled=!0,_.defaultClient=null,$e=!1,$r&&$r.dispose(),Vr&&Vr.dispose(),Br&&Br.dispose(),Gr&&Gr.dispose(),Zt&&Zt.dispose(),Ct&&Ct.dispose(),zr&&zr.dispose(),_.liveMetricsClient&&(_.liveMetricsClient.enable(!1),ii=!1,_.liveMetricsClient=void 0)}_.dispose=jm});var wa=d((si,Op)=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.default=Bm;var $m=Vm(require("crypto"));function Vm(e){return e&&e.__esModule?e:{default:e}}function Bm(){return $m.default.randomBytes(16)}Op.exports=si.default});var ai=d((Wr,kp)=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.default=void 0;var Np=[];for(Qr=0;Qr<256;++Qr)Np[Qr]=(Qr+256).toString(16).substr(1);var Qr;function Gm(e,t){var r=t||0,n=Np;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var zm=Gm;Wr.default=zm;kp.exports=Wr.default});var Fp=d((Xr,Hp)=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.default=void 0;var Qm=Lp(wa()),Wm=Lp(ai());function Lp(e){return e&&e.__esModule?e:{default:e}}var Mp,Sa,Da=0,Aa=0;function Xm(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var s=e.node||Mp,a=e.clockseq!==void 0?e.clockseq:Sa;if(s==null||a==null){var o=e.random||(e.rng||Qm.default)();s==null&&(s=Mp=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),a==null&&(a=Sa=(o[6]<<8|o[7])&16383)}var c=e.msecs!==void 0?e.msecs:new Date().getTime(),u=e.nsecs!==void 0?e.nsecs:Aa+1,l=c-Da+(u-Aa)/1e4;if(l<0&&e.clockseq===void 0&&(a=a+1&16383),(l<0||c>Da)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Da=c,Aa=u,Sa=a,c+=122192928e5;var p=((c&268435455)*1e4+u)%4294967296;i[n++]=p>>>24&255,i[n++]=p>>>16&255,i[n++]=p>>>8&255,i[n++]=p&255;var f=c/4294967296*1e4&268435455;i[n++]=f>>>8&255,i[n++]=f&255,i[n++]=f>>>24&15|16,i[n++]=f>>>16&255,i[n++]=a>>>8|128,i[n++]=a&255;for(var v=0;v<6;++v)i[n+v]=s[v];return t||(0,Wm.default)(i)}var Km=Xm;Xr.default=Km;Hp.exports=Xr.default});var Pa=d(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.default=t_;Tt.URL=Tt.DNS=void 0;var Ym=Jm(ai());function Jm(e){return e&&e.__esModule?e:{default:e}}function Zm(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(r){t.push(parseInt(r,16))}),t}function e_(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}var Up="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Tt.DNS=Up;var jp="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Tt.URL=jp;function t_(e,t,r){var n=function(i,s,a,o){var c=a&&o||0;if(typeof i=="string"&&(i=e_(i)),typeof s=="string"&&(s=Zm(s)),!Array.isArray(i))throw TypeError("value must be an array of bytes");if(!Array.isArray(s)||s.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var u=r(s.concat(i));if(u[6]=u[6]&15|t,u[8]=u[8]&63|128,a)for(var l=0;l<16;++l)a[c+l]=u[l];return a||(0,Ym.default)(u)};try{n.name=e}catch{}return n.DNS=Up,n.URL=jp,n}});var Vp=d((Kr,$p)=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.default=void 0;var r_=n_(require("crypto"));function n_(e){return e&&e.__esModule?e:{default:e}}function i_(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),r_.default.createHash("md5").update(e).digest()}var s_=i_;Kr.default=s_;$p.exports=Kr.default});var zp=d((Yr,Gp)=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.default=void 0;var a_=Bp(Pa()),o_=Bp(Vp());function Bp(e){return e&&e.__esModule?e:{default:e}}var c_=(0,a_.default)("v3",48,o_.default),u_=c_;Yr.default=u_;Gp.exports=Yr.default});var Xp=d((Jr,Wp)=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.default=void 0;var l_=Qp(wa()),p_=Qp(ai());function Qp(e){return e&&e.__esModule?e:{default:e}}function f_(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||l_.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var s=0;s<16;++s)t[n+s]=i[s];return t||(0,p_.default)(i)}var d_=f_;Jr.default=d_;Wp.exports=Jr.default});var Yp=d((Zr,Kp)=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.default=void 0;var h_=v_(require("crypto"));function v_(e){return e&&e.__esModule?e:{default:e}}function g_(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),h_.default.createHash("sha1").update(e).digest()}var m_=g_;Zr.default=m_;Kp.exports=Zr.default});var ef=d((en,Zp)=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.default=void 0;var __=Jp(Pa()),y_=Jp(Yp());function Jp(e){return e&&e.__esModule?e:{default:e}}var E_=(0,__.default)("v5",80,y_.default),C_=E_;en.default=C_;Zp.exports=en.default});var tf=d(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});Object.defineProperty(er,"v1",{enumerable:!0,get:function(){return T_.default}});Object.defineProperty(er,"v3",{enumerable:!0,get:function(){return b_.default}});Object.defineProperty(er,"v4",{enumerable:!0,get:function(){return I_.default}});Object.defineProperty(er,"v5",{enumerable:!0,get:function(){return x_.default}});var T_=oi(Fp()),b_=oi(zp()),I_=oi(Xp()),x_=oi(ef());function oi(e){return e&&e.__esModule?e:{default:e}}});var nf=d((ZE,rf)=>{"use strict";function w_(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}rf.exports=w_});var M_={};xf(M_,{activate:()=>N_,deactivate:()=>k_});module.exports=wf(M_);var _i=require("vscode");var fe=class{constructor(){this.disposables=[]}push(...t){this.disposables.push(...t)}onDispose(){}dispose(){try{this.onDispose()}catch(t){}for(let t of this.disposables)t.dispose();this.disposables=[]}};var Ze=require("vscode");var xe=require("console"),$a=require("fs"),Va=require("zlib"),Ba=require("readline");var an=class{constructor(){this.headers=new Map;this._events=[];this.callsites=[]}get version(){return this.headers.get("version")}get creator(){return this.headers.get("creator")}get cmd(){return this.headers.get("cmd")}get description(){return this.headers.get("desc")}get positions(){return this.headers.get("positions")}get summary(){let t=this.headers.get("summary"),r=-1,n=-1;return t&&t.indexOf(" ")>0&&([r,n]=t.split(" ").map(i=>parseInt(i))),{time:r,memory:n}}get events(){if(this._events.length==0){let t=this.headers.get("events");t&&(this._events=t.split(" ").map(r=>r.trim()))}return this._events}get costEvent(){let t=this.events;return t&&t.length!=0?t[0]:void 0}},on=class{constructor(t,r,n=1,i=0,s=0){this.callee=t;this.line=r;this.callcount=n;this.cost=i;this.memory=s}},cn=class{constructor(t,r,n,i=0,s=0){this.file=t;this.fnname=r;this.line=n;this.selfcost=i;this.selfmemory=s;this.calls=[];this.callcount=0}get isPhpInternal(){return this.file=="php:internal"}get allcost(){let t=this.selfcost;return this.calls.forEach(r=>{t+=r.cost}),t}};function rt(e,t){let r=e.events;return r.length&&r[0]=="Time_(10ns)"?t/1e8:0}var cr=class{constructor(){this._array=[]}set(t,r){if(t<0)throw new Error;if(t>=this._array.length){let n=(t+1)*2;this._array.push(...new Array(n-this._array.length))}this._array[t]=r}get(t){return t>=0&&t<this._array.length?this._array[t]:void 0}has(t){return t>=0&&t<=this._array.length&&this._array[t]!==void 0}getOrAdd(t,r){if(t){let n=this.get(t);if(n!==void 0)return n;r&&this.set(t,r)}return r}};var Ei=class{constructor(t,r,n,i,s){this.file=t;this.fnname=r;this.line=n;this.cost=i;this.memory=s}};var un;(t=>{class e{constructor(){this._files=new cr;this._functions=new cr;this._fnmap=new Map;this._callsites=[];this._calls=[];this._model=new an}fn(n,i){return this._currentFn=this._functions.getOrAdd(n,i)}fl(n,i){return this._currentFl=this._files.getOrAdd(n,i)}cfn(n,i){return this._currentCfn=this._functions.getOrAdd(n,i)}cfl(n,i){return this._currentCfl=this._files.getOrAdd(n,i)}parse(n,i){for(var s=0;s<n.length;){var a=n.indexOf(`
`,s);if(this.line(n.substring(s,a>=0?a:n.length).trim()),a<0)break;s=a+1}}line(n){if(!n||!n.length||n[0]=="#")return!0;let i=n.match(/^([a-z]+)=[\s]*(\(([+-]?[0-9]+)\))?\s*(.*)?$/i);if(i&&i[1]&&(i[3]||i[4])){let o=i[1],c=i[3]?parseInt(i[3]):void 0,u=i[4];switch(o){case"fl":this.fl(c,u);break;case"fn":this.fn(c,u);break;case"cfl":this.cfl(c,u);break;case"cfn":this.cfn(c,u);break;case"calls":break}return this._currentPos=o,!0}if(n.match(/^[0-9\s+\-]+$/i)){let o=n.split(" ").map(c=>parseInt(c.trim()));switch((0,xe.assert)(o.length==3),this._currentPos){case"fn":(0,xe.assert)(this._currentFn),this.endCall();let c=this._currentFn,u=c!="{main}"?c:this._currentFl,l=this._fnmap.get(u);if(l===void 0){let p=this._currentFl,f=p!="php:internal"?o[0]:-1;this._fnmap.set(u,l=new cn(p,c,f)),this._model.callsites.push(l)}l.selfcost+=o[1],l.selfmemory+=o[2],l.callcount++,this._callsite=l;break;case"cfn":case"calls":(0,xe.assert)(this._currentCfn),this._calls.push(new Ei(this._currentCfl,this._currentCfn,o[0],o[1],o[2]));break}return!0}let a=n.match(/^([a-z]+):\s*(.*)$/i);return a?(this._model.headers.set(a[1].toLowerCase(),a[2]),!0):!1}endCall(){let n=this._callsite;if(n){let i=this._calls.length;i&&((0,xe.assert)(this._callsites.length>=i),this._callsites.splice(this._callsites.length-i,i).forEach((a,o)=>{var c=this._calls[o];(0,xe.assert)(c.file==a.file),(0,xe.assert)(c.fnname==a.fnname),n.calls.push(new on(a,c.line,1,c.cost,c.memory))}),this._calls=[]),this._callsites.push(n),this._callsite=void 0}else(0,xe.assert)(this._calls.length==0)}close(){this.endCall(),(0,xe.assert)(this._callsites.length>=1),this._model.roots=this._callsites,this._callsites=[]}static parseFile(n,i){return i==null||i.update({message:`opening file '${n}' ...`}),new Promise((s,a)=>{let o=!1,c=new e;c._model.path=n;let u=(0,$a.createReadStream)(n);u.on("open",l=>{let p;n.endsWith(".gz")&&(i==null||i.update({message:"using ungzip"}),p=(0,Va.createGunzip)(),p.on("error",v=>{o=!0,a(v)}));let f=(0,Ba.createInterface)({input:p?u.pipe(p):u});f.on("line",v=>{if(!c.line(v)){o=!0;let m=v.length>64?`${v.substring(0,64)} ...`:v;a(`Unexpected line: '${m}'`)}}),f.on("close",()=>{c.close(),o||(i==null||i.update({message:`processed: ${c._fnmap.size} function(s)`}),i==null||i.update({message:`creator: ${c._model.creator}`}),i==null||i.update({message:"successful."}),s(c._model))})}),u.on("error",l=>{o=!0,a(l)})})}static parseText(n,i){let s=new e;return s.parse(n,i),s.close(),(0,xe.assert)(s._callsites.length==0,"stack of callsites is not empty"),s._model}}t.Parser=e})(un||(un={}));var Df=require("vscode"),Af=or(Ci());function Ti(e){return e.map(t=>String.fromCharCode(t)).join("")}var Qa=require("vscode"),Rf=or(Ci());var Wa=require("fs");var bi=class{constructor(){this.dictionary={};this.locale="en";try{if(process&&process.env){let t=JSON.parse(process.env.VSCODE_NLS_CONFIG);t&&typeof t.locale=="string"&&(this.locale=t.locale)}}catch(t){}}read_i18n(t){try{let r=Buffer.from((0,Wa.readFileSync)(t)).toString("utf-8");return JSON.parse(r)}catch(r){return{}}}localize(t){let r=this.dictionary[t];if(typeof r=="string")return r}load(t){try{this.dictionary=Object.assign({},this.read_i18n(t.asAbsolutePath("package.nls.json")),this.read_i18n(t.asAbsolutePath("package.nls.en.json")),this.read_i18n(t.asAbsolutePath(`package.nls.${this.locale}.json`)))}catch(r){}}},qf=new bi;function Xa(e){return C(this,null,function*(){yield qf.load(e)})}var ui=or(qp()),sf=require("os"),Pe=require("vscode");var li=require("fs");var af=or(tf()),of=require("path"),ci=or(oe());var S_=[101,56,52,97,53,57,53,55,45,100,54,56,48,45,52,99,99,53,45,57,50,54,55,45,53,101,53,101,51,100,48,97,56,100,53,55],qa=class{constructor(t){this.client=t;ui.Configuration.setAutoCollectExceptions(!0).setUseDiskRetryCaching(!0).setAutoCollectConsole(!0,!0).setInternalLogging(!0,!0)}init(t,r){let n=A_(t),i=(0,sf.userInfo)().username;this.client.context.tags["ai.device.model"]=`Visual Studio Code ${Pe.version}`,this.client.context.tags["ai.user.id"]=i,this.client.context.tags["ai.user.accountId"]=nf()(i).toString(),this.client.context.tags["ai.session.id"]=af.v1(),this.client.context.tags["ai.application.ver"]=n.version,this.client.commonProperties=Object.bind(this.client.commonProperties,r,{"process.platform":process.platform,"process.arch":process.arch,"extension.id":t.extension.id});for(let s in n)this.client.commonProperties["server."+s]=n[s];this.track("extension loaded",{"copilot.enabled":Ra("github.copilot"),"phptools.enabled":Ra("devsense.phptools-vscode"),"intelephense.enabled":Ra("bmewburn.vscode-intelephense-client")})}track(t,r,n){if(!Pe.env.isTelemetryEnabled)return;let i={name:t,properties:Object.bind({},r)};n&&(i.measurements=n),this.client.trackEvent(i)}metric(t,r,n,i,s,a){this.client.trackMetric({name:t,value:r,count:n,min:i,max:s,stdDev:a})}error(t,r,n){if(n=Object.bind({},n),!Pe.env.isTelemetryEnabled){var i=Pe.workspace.getConfiguration().get("telemetry.telemetryLevel");if(i!="error"&&(i!="crash"||r!="critical"))return}this.client.trackException({exception:t,severity:r=="critical"?ci.SeverityLevel.Critical:r=="error"?ci.SeverityLevel.Error:ci.SeverityLevel.Warning,properties:n})}},pi=new qa(new ui.TelemetryClient(Ti(S_)));function Ke(e,t){pi.track(e,t)}function cf(e,t,r){pi.error(e,t?"critical":"error",r)}function D_(e){let t="out/server/version.json";return e?e.asAbsolutePath(t):(0,of.join)(__filename,"../../..",t)}function A_(e){let t=D_(e);try{if((0,li.existsSync)(t))return JSON.parse((0,li.readFileSync)(t,"utf8"))||{}}catch(n){}let r=e.extension.packageJSON.version;return{target:`${process.platform}-${process.arch}`,version:r}}function Ra(e){return Pe.extensions.getExtension(e)!==void 0}var df=require("fs"),Je=require("vscode");var P_=0;function fi(){return++P_}function uf(e,t,r){if(!(!t&&!r)){for(let n of e.callsites)if(t&&t(n),r&&n.calls&&n.calls.length)for(let i of n.calls)r(n,i)}}function tn(e,t,r,n,i){if(r.calls&&r.calls.length){if(i.size==i.add(r).size)return;if(n(e,t,r))for(let s of r.calls)tn(r,s,s.callee,n,i);i.delete(r)}else n(e,t,r)}function Oa(e){let t=new Map,r=e.summary,n=fi();return e.roots.forEach(i=>{tn(void 0,void 0,i,(s,a,o)=>{let c=t.get(o);return c===void 0&&t.set(o,c={file:o.file,fnname:o.fnname,line:o.line,selftime:rt(e,o.selfcost),time:0,calls:o.callcount}),c.time+=rt(e,a?a.cost:r.time),o.color!=n?(o.color=n,!0):!1},new Set)}),t}function Na(e,t,r){let n={callers:[],self:void 0,called:[]},i=new Set,s=a=>a.map(o=>r.get(o)).filter(o=>o!==void 0).sort((o,c)=>c.time-o.time);return uf(e,a=>{a.fnname==t&&(n.self=r.get(a),n.called=s([...new Set(a.calls.map(o=>o.callee))]))},(a,o)=>{o.callee.fnname==t&&i.add(a)}),n.callers=s([...i]),n}var lf=require("vscode");function pf(e,t){return e>t?e:t}var Ye=require("vscode");function ff(e,t){return C(this,null,function*(){let r=yield Ye.workspace.openTextDocument(e);if(r){let n=yield Ye.window.showTextDocument(r,{});if(n)return t&&(n.selections=[new Ye.Selection(t,t)],n.revealRange(new Ye.Range(t,t))),!0}return!1})}var _e=require("vscode");var di=class extends fe{constructor(r,n,i){super();this.context=r;this.id=n;this.panel=i;this._onPanelClosed=new _e.EventEmitter;this.onPanelClose=this._onPanelClosed.event,this.hookPanel()}hookPanel(){this.panel&&(this.panel.onDidDispose(()=>{this.panel=void 0,this._onPanelClosed.fire(this)}),this.panel.webview.onDidReceiveMessage(r=>C(this,null,function*(){return yield this.onMessage(r)})))}show(){return C(this,null,function*(){yield _e.window.withProgress({location:_e.ProgressLocation.Window},()=>C(this,null,function*(){this.panel==null?(this.panel=_e.window.createWebviewPanel(this.id,this.title(),_e.ViewColumn.One,{enableScripts:!0,enableCommandUris:!0,retainContextWhenHidden:!0}),this.hookPanel()):this.panel.reveal(_e.ViewColumn.One),this.panel.webview.html=yield this.html()}))})}onMessage(r){return C(this,null,function*(){})}update(){return C(this,null,function*(){})}updateTitle(){this.panel.title=this.title()}postMessage(r){return C(this,null,function*(){this.panel&&(yield this.panel.webview.postMessage(r))})}title(){return this.id}html(){return C(this,null,function*(){let r=this.getUri("webviews","toolkit.min.js"),n=this.getUri("webviews","main.js"),i=this.getUri("webviews","main.css"),s=this.getUri("webviews","codicon.css");return`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <link href="${i}" rel="stylesheet" />
                <link href="${s}" rel="stylesheet" />
                <script type="module" src="${r}"><\/script>
                <script type="module" src="${n}"><\/script>
                <title>${this.title}</title>
            </head>
            <body>
                <div id='content'>
                    ${yield this.htmlBody()}
                </div>
            </body>
            </html>`})}htmlBody(){return C(this,null,function*(){return""})}getUri(...r){return this.panel.webview.asWebviewUri(_e.Uri.joinPath(this.context.extensionUri,...r))}dispose(){this.panel&&(this.panel.dispose(),this.panel=void 0),super.dispose()}};var hi=class extends di{constructor(r,n){super(r,"phpprofiler.webview.profile",n);this._onHighlightChanged=new Je.EventEmitter;this._highlight=!0;this.onHighlightChanged=this._onHighlightChanged.event}get highlight(){return this._highlight}set highlight(r){this._highlight!=r&&(this._highlight=r,this._onHighlightChanged.fire(r))}update(){return C(this,null,function*(){let r=this._model,n=r.summary;if(r===void 0)return;Ke("profiler: webview"),this.postMessage({command:"summary",data:{time:rt(r,n.time),memory:n.memory}}),this.loading({enabled:!0,message:"sorting functions"});let i=Oa(r);this.postMessage({command:"fndetails",data:Na(r,"{main}",i)}),this.postMessage({command:"functions",data:Array.from(i.values()).sort((s,a)=>a.time-s.time)}),this.loading({enabled:!1})})}loading(r){this.postMessage({command:"loading",data:r})}setModel(r){return C(this,null,function*(){this._model=r,this.updateTitle(),yield this.update()})}htmlBody(){return C(this,null,function*(){let r=Je.Uri.joinPath(this.context.extensionUri,"webviews","profileView.html");return(0,df.readFileSync)(r.fsPath,{encoding:"utf-8"})})}title(){if(this._model&&this._model.path){let r=Je.Uri.file(this._model.path).path.match(/[/\\]([^/\\]+)$/i);if(r)return r[1]}return"profiling result"}onMessage(r){return C(this,null,function*(){switch(r.command){case"navigate":r.data.file!="php:internal"&&(yield ff(Je.Uri.file(r.data.file),new Je.Position(pf(0,r.data.line),0)));break;case"inspect":this.postMessage({command:"fndetails",data:Na(this._model,r.data.fnname,Oa(this._model))});break;case"check-highlight":this.highlight=r.data;break}})}};var vi=class extends fe{constructor(r,n,i){super();this.context=r;this.log=n;this.decorator=i;this.push(Ze.commands.registerCommand("phpprofiler.openfile",()=>C(this,null,function*(){return yield this.openCachegrindFile()})),Ze.commands.registerCommand("phpprofiler.loadprofile",(...s)=>C(this,null,function*(){return yield this.loadCacheGrindFile(s[0])})))}get lastUriKey(){return"lastprofilesuri"}get lastUri(){return this.context.globalState.get(this.lastUriKey)}set lastUri(r){this.context.globalState.update(this.lastUriKey,r)}openCachegrindFile(){return C(this,null,function*(){let r=yield Ze.window.showOpenDialog({canSelectFiles:!0,defaultUri:this.lastUri,filters:{"Cachegrind Files":["gz","*","cachegrind"],"All Files":["*"]}});r&&r.length==1&&(this.lastUri=Ze.Uri.joinPath(r[0],".."),yield this.loadCacheGrindFile({path:r[0].fsPath,openInEditor:!0}))})}loadCacheGrindFile(r){return C(this,null,function*(){if(!(r!=null&&r.path))throw new Error("Missing {path:string} argument!");Ke("profiler: loading file",{path:r.path});let n=r.openInEditor||r.existingPanel?new hi(this.context,r.existingPanel):void 0;yield n==null?void 0:n.show();let i=yield un.Parser.parseFile(r.path,{update:s=>{s.message&&(n==null||n.loading({enabled:!0,message:s.message,progress:s.percent}),this.log.appendLine(`${new Date().toLocaleTimeString()}: ${s.message}`))}}).catch(s=>{cf(s),Ze.window.showErrorMessage(s!=null&&s.message?s.message:s),this.log.appendLine(`${new Date().toLocaleTimeString()}: ${s}`),n==null||n.dispose()});if(!i){n==null||n.dispose();return}n&&(yield n.setModel(i),n.onHighlightChanged(s=>C(this,null,function*(){s?this.decorator.setModel(i):this.decorator.model==i&&this.decorator.setModel(void 0)})),n.onPanelClose(s=>C(this,null,function*(){this.decorator.model==i&&this.decorator.setModel(void 0)}))),(n==null||n.highlight)&&(yield this.decorator.setModel(i))})}};var mi=require("vscode");var q_="phpprofiler.cachegrind",gi=class extends fe{constructor(r){super();this.context=r;this.push(mi.window.registerCustomEditorProvider(q_,this,{supportsMultipleEditorsPerDocument:!0,webviewOptions:{retainContextWhenHidden:!0}}))}openCustomDocument(r,n,i){return new ka(r)}resolveCustomEditor(r,n,i){return C(this,null,function*(){n.webview.options={enableScripts:!0,enableCommandUris:!0},yield mi.commands.executeCommand("phpprofiler.loadprofile",{path:r.uri.fsPath,openInEditor:!0,existingPanel:n})})}},ka=class{constructor(t){this.uri=t}dispose(){}};var ie=require("vscode");var hf=1,tr=class extends fe{constructor(r){super();this.log=r;this.decorations=new Map;this._hotPathTreshold=hf/100;this.decorationTypes=this.createDecorations(),this.updateHotPathTreshold(),this.push(ie.window.onDidChangeVisibleTextEditors(n=>this.update(n)),ie.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("phpprofiler.hotpath.treshold")&&this.updateHotPathTreshold()})),this.update(ie.window.visibleTextEditors)}get model(){return this._model}updateHotPathTreshold(){return C(this,null,function*(){let r=ie.workspace.getConfiguration().get("phpprofiler.hotpath.treshold",hf)/100;r!=this._hotPathTreshold&&(this._hotPathTreshold=r,yield this.setModel(this._model))})}createDecorations(){return[this.createDecorationType(0),this.createDecorationType(.33),this.createDecorationType(.66),this.createDecorationType(1)]}createDecorationType(r){let n=(255-r*64).toFixed(0),i=(48+128*r).toFixed(0);return ie.window.createTextEditorDecorationType({isWholeLine:!0,rangeBehavior:ie.DecorationRangeBehavior.ClosedClosed,light:{backgroundColor:`rgba(255,${n},${n},255)`},dark:{backgroundColor:`rgba(${i},0,16,255)`},after:{fontStyle:"italic",color:new ie.ThemeColor("disabledForeground"),margin:"0 0 16px 0",textDecoration:"vertical-align:middle;float:right;"}})}getDecorationType(r){let n=this.decorationTypes.length,i=Math.round((r-this._hotPathTreshold)/(1-this._hotPathTreshold)*n+.5);return i>=n-1?this.decorationTypes[n-1]:this.decorationTypes[i]}setModel(r){return C(this,null,function*(){if(this._model=r,this.log.appendLine(r?`Highlighting '${r.path}' ...`:"Clearing highlight."),this.decorations.clear(),r){let n=new Map,i=r.summary.time;if(r&&r.roots){let s=fi();r.roots.forEach(a=>{tn(void 0,void 0,a,(o,c,u)=>{if(o&&c.line>=0&&o.file!="php:internal"){let l=n.get(o.file);l==null&&n.set(o.file,l=new Map);let p=l.get(c.line);l.set(c.line,(p||0)+c.cost)}return u.color!=s?(u.color=s,!0):!1},new Set)})}for(let s of n.entries()){let a=[];for(let o of s[1].entries()){let c=o[1],u=c/i;if(u>=this._hotPathTreshold){let l=o[0],p=rt(r,c);a.push({decoration:tr.createDecoration(l-1,p,u*100),type:this.getDecorationType(u)})}}a.length&&this.decorations.set(s[0].toLowerCase(),a)}}this.update(ie.window.visibleTextEditors)})}static createDecoration(r,n,i){return{renderOptions:{after:{contentText:`Time: ${(n*1e3).toFixed(2)} ms (${i.toFixed(2)}%)`}},range:new ie.Range(r,0,r,1)}}documentDecorations(r){let n=this.decorations.get(r.uri.fsPath.toLowerCase());if(n==null&&this.decorations.size!=0){let i="/"+ie.workspace.asRelativePath(r.uri,!1),s=9999;this.decorations.forEach((a,o)=>{o.replaceAll("\\","/").endsWith(i)&&(n==null||o.length<s)&&(n=a,s=o.length)})}return n}update(r){r.forEach(n=>this.decorate(n))}decorate(r){let n=this.documentDecorations(r.document);for(let i of this.decorationTypes)n?(Ke("profiler: hot paths"),r.setDecorations(i,n.filter(s=>s.type==i).map(s=>s.decoration))):r.setDecorations(i,[])}};var O_;function N_(e){return C(this,null,function*(){return pi.init(e),Xa(e),e.subscriptions.push(O_=new Ma(e)),{openProfileFile(r){return C(this,null,function*(){return yield _i.commands.executeCommand("phpprofiler.loadprofile",{path:r,openInEditor:!0}),!0})}}})}function k_(){return C(this,null,function*(){Ke("extension unloaded (profiler)")})}var Ma=class extends fe{constructor(r){super();this.context=r;this.push(this.log=_i.window.createOutputChannel("PHP (Profiler)"),this.hotpathDecorator=new tr(this.log),new vi(this.context,this.log,this.hotpathDecorator),new gi(this.context))}};0&&(module.exports={activate,deactivate});
/**
 * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
 *
 * This can be used with JS designed for browsers to improve reuse of code and
 * allow the use of existing libraries.
 *
 * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
 *
 * @author Dan DeFelippi <dan@driverdan.com>
 * @contributor David Ellis <d.f.ellis@ieee.org>
 * @license MIT
 */
